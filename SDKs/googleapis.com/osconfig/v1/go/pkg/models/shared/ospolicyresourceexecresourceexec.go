// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
)

// OSPolicyResourceExecResourceExecInterpreterEnum - Required. The script interpreter to use.
type OSPolicyResourceExecResourceExecInterpreterEnum string

const (
	OSPolicyResourceExecResourceExecInterpreterEnumInterpreterUnspecified OSPolicyResourceExecResourceExecInterpreterEnum = "INTERPRETER_UNSPECIFIED"
	OSPolicyResourceExecResourceExecInterpreterEnumNone                   OSPolicyResourceExecResourceExecInterpreterEnum = "NONE"
	OSPolicyResourceExecResourceExecInterpreterEnumShell                  OSPolicyResourceExecResourceExecInterpreterEnum = "SHELL"
	OSPolicyResourceExecResourceExecInterpreterEnumPowershell             OSPolicyResourceExecResourceExecInterpreterEnum = "POWERSHELL"
)

func (e OSPolicyResourceExecResourceExecInterpreterEnum) ToPointer() *OSPolicyResourceExecResourceExecInterpreterEnum {
	return &e
}

func (e *OSPolicyResourceExecResourceExecInterpreterEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "INTERPRETER_UNSPECIFIED":
		fallthrough
	case "NONE":
		fallthrough
	case "SHELL":
		fallthrough
	case "POWERSHELL":
		*e = OSPolicyResourceExecResourceExecInterpreterEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for OSPolicyResourceExecResourceExecInterpreterEnum: %v", v)
	}
}

// OSPolicyResourceExecResourceExec - A file or script to execute.
type OSPolicyResourceExecResourceExec struct {
	// Optional arguments to pass to the source during execution.
	Args []string `json:"args,omitempty"`
	// A remote or local file.
	File *OSPolicyResourceFile `json:"file,omitempty"`
	// Required. The script interpreter to use.
	Interpreter *OSPolicyResourceExecResourceExecInterpreterEnum `json:"interpreter,omitempty"`
	// Only recorded for enforce Exec. Path to an output file (that is created by this Exec) whose content will be recorded in OSPolicyResourceCompliance after a successful run. Absence or failure to read this file will result in this ExecResource being non-compliant. Output file size is limited to 100K bytes.
	OutputFilePath *string `json:"outputFilePath,omitempty"`
	// An inline script. The size of the script is limited to 32KiB.
	Script *string `json:"script,omitempty"`
}
