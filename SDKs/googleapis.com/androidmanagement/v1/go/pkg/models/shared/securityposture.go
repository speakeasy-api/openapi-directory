// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
)

// SecurityPostureDevicePostureEnum - Device's security posture value.
type SecurityPostureDevicePostureEnum string

const (
	SecurityPostureDevicePostureEnumPostureUnspecified     SecurityPostureDevicePostureEnum = "POSTURE_UNSPECIFIED"
	SecurityPostureDevicePostureEnumSecure                 SecurityPostureDevicePostureEnum = "SECURE"
	SecurityPostureDevicePostureEnumAtRisk                 SecurityPostureDevicePostureEnum = "AT_RISK"
	SecurityPostureDevicePostureEnumPotentiallyCompromised SecurityPostureDevicePostureEnum = "POTENTIALLY_COMPROMISED"
)

func (e SecurityPostureDevicePostureEnum) ToPointer() *SecurityPostureDevicePostureEnum {
	return &e
}

func (e *SecurityPostureDevicePostureEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "POSTURE_UNSPECIFIED":
		fallthrough
	case "SECURE":
		fallthrough
	case "AT_RISK":
		fallthrough
	case "POTENTIALLY_COMPROMISED":
		*e = SecurityPostureDevicePostureEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for SecurityPostureDevicePostureEnum: %v", v)
	}
}

// SecurityPosture - The security posture of the device, as determined by the current device state and the policies applied.
type SecurityPosture struct {
	// Device's security posture value.
	DevicePosture *SecurityPostureDevicePostureEnum `json:"devicePosture,omitempty"`
	// Additional details regarding the security posture of the device.
	PostureDetails []PostureDetail `json:"postureDetails,omitempty"`
}
