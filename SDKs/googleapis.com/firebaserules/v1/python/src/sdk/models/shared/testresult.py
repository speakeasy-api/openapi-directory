"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

from __future__ import annotations
import dataclasses
from ..shared import expressionreport as shared_expressionreport
from ..shared import functioncall as shared_functioncall
from ..shared import sourceposition as shared_sourceposition
from ..shared import visitedexpression as shared_visitedexpression
from dataclasses_json import Undefined, dataclass_json
from enum import Enum
from sdk import utils
from typing import Optional

class TestResultStateEnum(str, Enum):
    r"""State of the test."""
    STATE_UNSPECIFIED = 'STATE_UNSPECIFIED'
    SUCCESS = 'SUCCESS'
    FAILURE = 'FAILURE'


@dataclass_json(undefined=Undefined.EXCLUDE)
@dataclasses.dataclass
class TestResult:
    r"""Test result message containing the state of the test as well as a description and source position for test failures."""
    
    debug_messages: Optional[list[str]] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('debugMessages'), 'exclude': lambda f: f is None }})
    r"""Debug messages related to test execution issues encountered during evaluation. Debug messages may be related to too many or too few invocations of function mocks or to runtime errors that occur during evaluation. For example: ```Unable to read variable [name: \\"resource\\"]```"""  
    error_position: Optional[shared_sourceposition.SourcePosition] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('errorPosition'), 'exclude': lambda f: f is None }})
    r"""Position in the `Source` content including its line, column number, and an index of the `File` in the `Source` message. Used for debug purposes."""  
    expression_reports: Optional[list[shared_expressionreport.ExpressionReport]] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('expressionReports'), 'exclude': lambda f: f is None }})
    r"""The mapping from expression in the ruleset AST to the values they were evaluated to. Partially-nested to mirror AST structure. Note that this field is actually tracking expressions and not permission statements in contrast to the \\"visited_expressions\\" field above. Literal expressions are omitted."""  
    function_calls: Optional[list[shared_functioncall.FunctionCall]] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('functionCalls'), 'exclude': lambda f: f is None }})
    r"""The set of function calls made to service-defined methods. Function calls are included in the order in which they are encountered during evaluation, are provided for both mocked and unmocked functions, and included on the response regardless of the test `state`."""  
    state: Optional[TestResultStateEnum] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('state'), 'exclude': lambda f: f is None }})
    r"""State of the test."""  
    visited_expressions: Optional[list[shared_visitedexpression.VisitedExpression]] = dataclasses.field(default=None, metadata={'dataclasses_json': { 'letter_case': utils.get_field_name('visitedExpressions'), 'exclude': lambda f: f is None }})
    r"""The set of visited permission expressions for a given test. This returns the positions and evaluation results of all visited permission expressions which were relevant to the test case, e.g. ``` match /path { allow read if: } ``` For a detailed report of the intermediate evaluation states, see the `expression_reports` field"""  
    