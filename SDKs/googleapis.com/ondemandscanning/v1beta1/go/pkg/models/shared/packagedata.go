// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
)

// PackageDataPackageTypeEnum - The type of package: os, maven, go, etc.
type PackageDataPackageTypeEnum string

const (
	PackageDataPackageTypeEnumPackageTypeUnspecified PackageDataPackageTypeEnum = "PACKAGE_TYPE_UNSPECIFIED"
	PackageDataPackageTypeEnumOs                     PackageDataPackageTypeEnum = "OS"
	PackageDataPackageTypeEnumMaven                  PackageDataPackageTypeEnum = "MAVEN"
	PackageDataPackageTypeEnumGo                     PackageDataPackageTypeEnum = "GO"
	PackageDataPackageTypeEnumGoStdlib               PackageDataPackageTypeEnum = "GO_STDLIB"
	PackageDataPackageTypeEnumPypi                   PackageDataPackageTypeEnum = "PYPI"
	PackageDataPackageTypeEnumNpm                    PackageDataPackageTypeEnum = "NPM"
)

func (e *PackageDataPackageTypeEnum) UnmarshalJSON(data []byte) error {
	var s string
	if err := json.Unmarshal(data, &s); err != nil {
		return err
	}
	switch s {
	case "PACKAGE_TYPE_UNSPECIFIED":
		fallthrough
	case "OS":
		fallthrough
	case "MAVEN":
		fallthrough
	case "GO":
		fallthrough
	case "GO_STDLIB":
		fallthrough
	case "PYPI":
		fallthrough
	case "NPM":
		*e = PackageDataPackageTypeEnum(s)
		return nil
	default:
		return fmt.Errorf("invalid value for PackageDataPackageTypeEnum: %s", s)
	}
}

type PackageData struct {
	// The cpe_uri in [cpe format] (https://cpe.mitre.org/specification/) in which the vulnerability may manifest. Examples include distro or storage location for vulnerable jar.
	CpeURI *string `json:"cpeUri,omitempty"`
	// The dependency chain between this package and the user's artifact. List in order from the customer's package under review first, to the current package last. Inclusive of the original package and the current package.
	DependencyChain []LanguagePackageDependency `json:"dependencyChain,omitempty"`
	// The path to the jar file / go binary file.
	FileLocation []FileLocation `json:"fileLocation,omitempty"`
	// HashDigest stores the SHA512 hash digest of the jar file if the package is of type Maven. This field will be unset for non Maven packages.
	HashDigest *string     `json:"hashDigest,omitempty"`
	Maintainer *Maintainer `json:"maintainer,omitempty"`
	// The OS affected by a vulnerability Used to generate the cpe_uri for OS packages
	Os *string `json:"os,omitempty"`
	// The version of the OS Used to generate the cpe_uri for OS packages
	OsVersion *string `json:"osVersion,omitempty"`
	// The package being analysed for vulnerabilities
	Package *string `json:"package,omitempty"`
	// The type of package: os, maven, go, etc.
	PackageType *PackageDataPackageTypeEnum `json:"packageType,omitempty"`
	// CVEs that this package is no longer vulnerable to go/drydock-dd-custom-binary-scanning
	PatchedCve []string `json:"patchedCve,omitempty"`
	Unused     *string  `json:"unused,omitempty"`
	// The version of the package being analysed
	Version *string `json:"version,omitempty"`
}
