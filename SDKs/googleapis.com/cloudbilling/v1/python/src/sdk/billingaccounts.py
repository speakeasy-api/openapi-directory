"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

import requests as requests_http
from . import utils
from sdk.models import operations, shared
from typing import Optional

class BillingAccounts:
    _client: requests_http.Session
    _security_client: requests_http.Session
    _server_url: str
    _language: str
    _sdk_version: str
    _gen_version: str

    def __init__(self, client: requests_http.Session, security_client: requests_http.Session, server_url: str, language: str, sdk_version: str, gen_version: str) -> None:
        self._client = client
        self._security_client = security_client
        self._server_url = server_url
        self._language = language
        self._sdk_version = sdk_version
        self._gen_version = gen_version
        
    def cloudbilling_billing_accounts_create(self, request: operations.CloudbillingBillingAccountsCreateRequest, security: operations.CloudbillingBillingAccountsCreateSecurity) -> operations.CloudbillingBillingAccountsCreateResponse:
        r"""This method creates [billing subaccounts](https://cloud.google.com/billing/docs/concepts#subaccounts). Google Cloud resellers should use the Channel Services APIs, [accounts.customers.create](https://cloud.google.com/channel/docs/reference/rest/v1/accounts.customers/create) and [accounts.customers.entitlements.create](https://cloud.google.com/channel/docs/reference/rest/v1/accounts.customers.entitlements/create). When creating a subaccount, the current authenticated user must have the `billing.accounts.update` IAM permission on the parent account, which is typically given to billing account [administrators](https://cloud.google.com/billing/docs/how-to/billing-access). This method will return an error if the parent account has not been provisioned as a reseller account."""
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/billingAccounts'
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "billing_account_input", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsCreateRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('POST', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsCreateResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.BillingAccount])
                res.billing_account = out

        return res

    def cloudbilling_billing_accounts_get(self, request: operations.CloudbillingBillingAccountsGetRequest, security: operations.CloudbillingBillingAccountsGetSecurity) -> operations.CloudbillingBillingAccountsGetResponse:
        r"""Gets information about a billing account. The current authenticated user must be a [viewer of the billing account](https://cloud.google.com/billing/docs/how-to/billing-access)."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsGetRequest, base_url, '/v1/{name}', request)
        
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsGetRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsGetResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.BillingAccount])
                res.billing_account = out

        return res

    def cloudbilling_billing_accounts_get_iam_policy(self, request: operations.CloudbillingBillingAccountsGetIamPolicyRequest, security: operations.CloudbillingBillingAccountsGetIamPolicySecurity) -> operations.CloudbillingBillingAccountsGetIamPolicyResponse:
        r"""Gets the access control policy for a billing account. The caller must have the `billing.accounts.getIamPolicy` permission on the account, which is often given to billing account [viewers](https://cloud.google.com/billing/docs/how-to/billing-access)."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsGetIamPolicyRequest, base_url, '/v1/{resource}:getIamPolicy', request)
        
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsGetIamPolicyRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsGetIamPolicyResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.Policy])
                res.policy = out

        return res

    def cloudbilling_billing_accounts_list(self, request: operations.CloudbillingBillingAccountsListRequest, security: operations.CloudbillingBillingAccountsListSecurity) -> operations.CloudbillingBillingAccountsListResponse:
        r"""Lists the billing accounts that the current authenticated user has permission to [view](https://cloud.google.com/billing/docs/how-to/billing-access)."""
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/billingAccounts'
        
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsListRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsListResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ListBillingAccountsResponse])
                res.list_billing_accounts_response = out

        return res

    def cloudbilling_billing_accounts_patch(self, request: operations.CloudbillingBillingAccountsPatchRequest, security: operations.CloudbillingBillingAccountsPatchSecurity) -> operations.CloudbillingBillingAccountsPatchResponse:
        r"""Updates a billing account's fields. Currently the only field that can be edited is `display_name`. The current authenticated user must have the `billing.accounts.update` IAM permission, which is typically given to the [administrator](https://cloud.google.com/billing/docs/how-to/billing-access) of the billing account."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsPatchRequest, base_url, '/v1/{name}', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "billing_account_input", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsPatchRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('PATCH', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsPatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.BillingAccount])
                res.billing_account = out

        return res

    def cloudbilling_billing_accounts_projects_list(self, request: operations.CloudbillingBillingAccountsProjectsListRequest, security: operations.CloudbillingBillingAccountsProjectsListSecurity) -> operations.CloudbillingBillingAccountsProjectsListResponse:
        r"""Lists the projects associated with a billing account. The current authenticated user must have the `billing.resourceAssociations.list` IAM permission, which is often given to billing account [viewers](https://cloud.google.com/billing/docs/how-to/billing-access)."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsProjectsListRequest, base_url, '/v1/{name}/projects', request)
        
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsProjectsListRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsProjectsListResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ListProjectBillingInfoResponse])
                res.list_project_billing_info_response = out

        return res

    def cloudbilling_billing_accounts_set_iam_policy(self, request: operations.CloudbillingBillingAccountsSetIamPolicyRequest, security: operations.CloudbillingBillingAccountsSetIamPolicySecurity) -> operations.CloudbillingBillingAccountsSetIamPolicyResponse:
        r"""Sets the access control policy for a billing account. Replaces any existing policy. The caller must have the `billing.accounts.setIamPolicy` permission on the account, which is often given to billing account [administrators](https://cloud.google.com/billing/docs/how-to/billing-access)."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsSetIamPolicyRequest, base_url, '/v1/{resource}:setIamPolicy', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "set_iam_policy_request", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsSetIamPolicyRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('POST', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsSetIamPolicyResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.Policy])
                res.policy = out

        return res

    def cloudbilling_billing_accounts_test_iam_permissions(self, request: operations.CloudbillingBillingAccountsTestIamPermissionsRequest, security: operations.CloudbillingBillingAccountsTestIamPermissionsSecurity) -> operations.CloudbillingBillingAccountsTestIamPermissionsResponse:
        r"""Tests the access control policy for a billing account. This method takes the resource and a set of permissions as input and returns the subset of the input permissions that the caller is allowed for that resource."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.CloudbillingBillingAccountsTestIamPermissionsRequest, base_url, '/v1/{resource}:testIamPermissions', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "test_iam_permissions_request", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.CloudbillingBillingAccountsTestIamPermissionsRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('POST', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CloudbillingBillingAccountsTestIamPermissionsResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.TestIamPermissionsResponse])
                res.test_iam_permissions_response = out

        return res

    