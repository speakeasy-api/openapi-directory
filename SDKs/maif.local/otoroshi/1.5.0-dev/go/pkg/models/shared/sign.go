// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"bytes"
	"encoding/json"
	"errors"
)

type SignAlgoSettingsType string

const (
	SignAlgoSettingsTypeHSAlgoSettings   SignAlgoSettingsType = "HSAlgoSettings"
	SignAlgoSettingsTypeRSAlgoSettings   SignAlgoSettingsType = "RSAlgoSettings"
	SignAlgoSettingsTypeESAlgoSettings   SignAlgoSettingsType = "ESAlgoSettings"
	SignAlgoSettingsTypeJWKSAlgoSettings SignAlgoSettingsType = "JWKSAlgoSettings"
)

type SignAlgoSettings struct {
	HSAlgoSettings   *HSAlgoSettings
	RSAlgoSettings   *RSAlgoSettings
	ESAlgoSettings   *ESAlgoSettings
	JWKSAlgoSettings *JWKSAlgoSettings

	Type SignAlgoSettingsType
}

func CreateSignAlgoSettingsHSAlgoSettings(hsAlgoSettings HSAlgoSettings) SignAlgoSettings {
	typ := SignAlgoSettingsTypeHSAlgoSettings

	return SignAlgoSettings{
		HSAlgoSettings: &hsAlgoSettings,
		Type:           typ,
	}
}

func CreateSignAlgoSettingsRSAlgoSettings(rsAlgoSettings RSAlgoSettings) SignAlgoSettings {
	typ := SignAlgoSettingsTypeRSAlgoSettings

	return SignAlgoSettings{
		RSAlgoSettings: &rsAlgoSettings,
		Type:           typ,
	}
}

func CreateSignAlgoSettingsESAlgoSettings(esAlgoSettings ESAlgoSettings) SignAlgoSettings {
	typ := SignAlgoSettingsTypeESAlgoSettings

	return SignAlgoSettings{
		ESAlgoSettings: &esAlgoSettings,
		Type:           typ,
	}
}

func CreateSignAlgoSettingsJWKSAlgoSettings(jwksAlgoSettings JWKSAlgoSettings) SignAlgoSettings {
	typ := SignAlgoSettingsTypeJWKSAlgoSettings

	return SignAlgoSettings{
		JWKSAlgoSettings: &jwksAlgoSettings,
		Type:             typ,
	}
}

func (u *SignAlgoSettings) UnmarshalJSON(data []byte) error {
	var d *json.Decoder

	hsAlgoSettings := new(HSAlgoSettings)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&hsAlgoSettings); err == nil {
		u.HSAlgoSettings = hsAlgoSettings
		u.Type = SignAlgoSettingsTypeHSAlgoSettings
		return nil
	}

	rsAlgoSettings := new(RSAlgoSettings)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&rsAlgoSettings); err == nil {
		u.RSAlgoSettings = rsAlgoSettings
		u.Type = SignAlgoSettingsTypeRSAlgoSettings
		return nil
	}

	esAlgoSettings := new(ESAlgoSettings)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&esAlgoSettings); err == nil {
		u.ESAlgoSettings = esAlgoSettings
		u.Type = SignAlgoSettingsTypeESAlgoSettings
		return nil
	}

	jwksAlgoSettings := new(JWKSAlgoSettings)
	d = json.NewDecoder(bytes.NewReader(data))
	d.DisallowUnknownFields()
	if err := d.Decode(&jwksAlgoSettings); err == nil {
		u.JWKSAlgoSettings = jwksAlgoSettings
		u.Type = SignAlgoSettingsTypeJWKSAlgoSettings
		return nil
	}

	return errors.New("could not unmarshal into supported union types")
}

func (u SignAlgoSettings) MarshalJSON() ([]byte, error) {
	if u.HSAlgoSettings != nil {
		return json.Marshal(u.HSAlgoSettings)
	}

	if u.RSAlgoSettings != nil {
		return json.Marshal(u.RSAlgoSettings)
	}

	if u.ESAlgoSettings != nil {
		return json.Marshal(u.ESAlgoSettings)
	}

	if u.JWKSAlgoSettings != nil {
		return json.Marshal(u.JWKSAlgoSettings)
	}

	return nil, nil
}

// Sign - Strategy where signature and field values are verified, and then token si re-signed
type Sign struct {
	AlgoSettings SignAlgoSettings `json:"algoSettings"`
	// String with value Sign
	Type string `json:"type"`
	// Settings to verify the value of JWT token fields
	VerificationSettings VerificationSettings `json:"verificationSettings"`
}
