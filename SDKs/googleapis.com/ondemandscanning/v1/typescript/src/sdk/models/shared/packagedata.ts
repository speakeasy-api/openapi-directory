/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { Binary } from "./binary";
import { FileLocation } from "./filelocation";
import { LanguagePackageDependency } from "./languagepackagedependency";
import { Maintainer } from "./maintainer";
import { Expose, Type } from "class-transformer";

/**
 * The type of package: os, maven, go, etc.
 */
export enum PackageDataPackageTypeEnum {
  PackageTypeUnspecified = "PACKAGE_TYPE_UNSPECIFIED",
  Os = "OS",
  Maven = "MAVEN",
  Go = "GO",
  GoStdlib = "GO_STDLIB",
  Pypi = "PYPI",
  Npm = "NPM",
}

export class PackageData extends SpeakeasyBase {
  /**
   * The architecture of the package.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "architecture" })
  architecture?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "binary" })
  @Type(() => Binary)
  binary?: Binary;

  /**
   * The cpe_uri in [cpe format] (https://cpe.mitre.org/specification/) in which the vulnerability may manifest. Examples include distro or storage location for vulnerable jar.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "cpeUri" })
  cpeUri?: string;

  /**
   * The dependency chain between this package and the user's artifact. List in order from the customer's package under review first, to the current package last. Inclusive of the original package and the current package.
   */
  @SpeakeasyMetadata({ elemType: LanguagePackageDependency })
  @Expose({ name: "dependencyChain" })
  @Type(() => LanguagePackageDependency)
  dependencyChain?: LanguagePackageDependency[];

  /**
   * The path to the jar file / go binary file.
   */
  @SpeakeasyMetadata({ elemType: FileLocation })
  @Expose({ name: "fileLocation" })
  @Type(() => FileLocation)
  fileLocation?: FileLocation[];

  /**
   * HashDigest stores the SHA512 hash digest of the jar file if the package is of type Maven. This field will be unset for non Maven packages.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "hashDigest" })
  hashDigest?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "maintainer" })
  @Type(() => Maintainer)
  maintainer?: Maintainer;

  /**
   * The OS affected by a vulnerability Used to generate the cpe_uri for OS packages
   */
  @SpeakeasyMetadata()
  @Expose({ name: "os" })
  os?: string;

  /**
   * The version of the OS Used to generate the cpe_uri for OS packages
   */
  @SpeakeasyMetadata()
  @Expose({ name: "osVersion" })
  osVersion?: string;

  /**
   * The package being analysed for vulnerabilities
   */
  @SpeakeasyMetadata()
  @Expose({ name: "package" })
  package?: string;

  /**
   * The type of package: os, maven, go, etc.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "packageType" })
  packageType?: PackageDataPackageTypeEnum;

  /**
   * CVEs that this package is no longer vulnerable to go/drydock-dd-custom-binary-scanning
   */
  @SpeakeasyMetadata()
  @Expose({ name: "patchedCve" })
  patchedCve?: string[];

  @SpeakeasyMetadata()
  @Expose({ name: "unused" })
  unused?: string;

  /**
   * The version of the package being analysed
   */
  @SpeakeasyMetadata()
  @Expose({ name: "version" })
  version?: string;
}
