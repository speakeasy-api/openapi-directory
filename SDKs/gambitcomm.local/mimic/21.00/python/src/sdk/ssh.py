"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

import requests as requests_http
from . import utils
from sdk.models import operations, shared
from typing import Any, Optional

class SSH:
    _client: requests_http.Session
    _security_client: requests_http.Session
    _server_url: str
    _language: str
    _sdk_version: str
    _gen_version: str

    def __init__(self, client: requests_http.Session, security_client: requests_http.Session, server_url: str, language: str, sdk_version: str, gen_version: str) -> None:
        self._client = client
        self._security_client = security_client
        self._server_url = server_url
        self._language = language
        self._sdk_version = sdk_version
        self._gen_version = gen_version
        
    def protocol_ssh_get_args(self, request: operations.ProtocolSSHGetArgsRequest) -> operations.ProtocolSSHGetArgsResponse:
        r"""Show the agent's SSH argument structure
        Agent's SSH configuration with port,rule,prompt,paging_prompt,userdb,keymap
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHGetArgsRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/get/args', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHGetArgsResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[dict[str, Any]])
                res.protocol_ssh_get_args_200_application_json_object = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_get_config(self, request: operations.ProtocolSSHGetConfigRequest) -> operations.ProtocolSSHGetConfigResponse:
        r"""Show the agent's SSH configuration
        Agent's SSH configuration with port,rule,prompt,paging_prompt,userdb,keymap
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHGetConfigRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/get/config', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHGetConfigResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ConfigSSH])
                res.config_ssh = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_get_statistics(self, request: operations.ProtocolSSHGetStatisticsRequest) -> operations.ProtocolSSHGetStatisticsResponse:
        r"""Show the agent's SSH statistics
        Statistics of fields indicated in the headers
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHGetStatisticsRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/get/statistics', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHGetStatisticsResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[list[int]])
                res.protocol_ssh_get_statistics_200_application_json_int32_integers = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_get_stats_hdr(self) -> operations.ProtocolSSHGetStatsHdrResponse:
        r"""Show the SSH statistics headers
        The headers of statistics fields
        """
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/mimic/protocol/msg/ssh/get/stats_hdr'
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHGetStatsHdrResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[list[str]])
                res.protocol_ssh_get_stats_hdr_200_application_json_strings = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_get_trace(self, request: operations.ProtocolSSHGetTraceRequest) -> operations.ProtocolSSHGetTraceResponse:
        r"""Show the agent's SSH traffic tracing
        Trace 1 means enabled, 0 means not
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHGetTraceRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/get/trace', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHGetTraceResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ConfigSSH])
                res.config_ssh = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_ipalias_disable(self, request: operations.ProtocolSSHIpaliasDisableRequest) -> operations.ProtocolSSHIpaliasDisableResponse:
        r"""Disable individual IP aliases on the agent and the simulator host
        By default, the MIMIC SSH server listens on all the IP addresses (aliases) that are configured for an agent
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHIpaliasDisableRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/ipalias/disable/{ipaddress}/{port}', request)
        
        
        client = self._security_client
        
        http_res = client.request('PUT', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHIpaliasDisableResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                res.protocol_ssh_ipalias_disable_200_application_json_string = http_res.content
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_ipalias_enable(self, request: operations.ProtocolSSHIpaliasEnableRequest) -> operations.ProtocolSSHIpaliasEnableResponse:
        r"""Enable individual IP aliases on the agent and the simulator host
        By default, the MIMIC SSH server listens on all the IP addresses (aliases) that are configured for an agent
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHIpaliasEnableRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/ipalias/enable/{ipaddress}/{port}', request)
        
        
        client = self._security_client
        
        http_res = client.request('PUT', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHIpaliasEnableResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                res.protocol_ssh_ipalias_enable_200_application_json_string = http_res.content
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_ipalias_isenabled(self, request: operations.ProtocolSSHIpaliasIsenabledRequest) -> operations.ProtocolSSHIpaliasIsenabledResponse:
        r"""Check individual IP aliases on the agent and the simulator host
        By default, the MIMIC SSH server listens on all the IP addresses (aliases) that are configured for an agent
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHIpaliasIsenabledRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/ipalias/isenabled/{ipaddress}/{port}', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHIpaliasIsenabledResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                res.protocol_ssh_ipalias_isenabled_200_application_json_string = http_res.content
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_ipalias_list(self, request: operations.ProtocolSSHIpaliasListRequest) -> operations.ProtocolSSHIpaliasListResponse:
        r"""List all IP aliases on the agent and the simulator host
        By default, the MIMIC SSH server listens on all the IP addresses (aliases) that are configured for an agent
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHIpaliasListRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/ipalias/list', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHIpaliasListResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[list[shared.IPAlias]])
                res.ip_aliases = out
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_set_config(self, request: operations.ProtocolSSHSetConfigRequest) -> operations.ProtocolSSHSetConfigResponse:
        r"""Set the agent's SSH configuration
        Agent's SSH configuration with port,rule,prompt,paging_prompt,userdb,keymap
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHSetConfigRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/set/config/{argument}/{value}', request)
        
        
        client = self._security_client
        
        http_res = client.request('PUT', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHSetConfigResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                res.protocol_ssh_set_config_200_application_json_string = http_res.content
        elif http_res.status_code == 400:
            pass

        return res

    def protocol_ssh_set_trace(self, request: operations.ProtocolSSHSetTraceRequest) -> operations.ProtocolSSHSetTraceResponse:
        r"""Set the agent's SSH traffic tracing
        1 to enable, 0 to disable
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProtocolSSHSetTraceRequest, base_url, '/mimic/agent/{agentNum}/protocol/msg/ssh/set/trace/{enableOrNot}', request)
        
        
        client = self._security_client
        
        http_res = client.request('PUT', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProtocolSSHSetTraceResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                res.protocol_ssh_set_trace_200_application_json_string = http_res.content
        elif http_res.status_code == 400:
            pass

        return res

    