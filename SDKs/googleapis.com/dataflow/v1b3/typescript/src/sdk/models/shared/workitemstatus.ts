/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { ApproximateProgress } from "./approximateprogress";
import { ApproximateReportedProgress } from "./approximatereportedprogress";
import { CounterUpdate } from "./counterupdate";
import { DynamicSourceSplit } from "./dynamicsourcesplit";
import { MetricUpdate } from "./metricupdate";
import { Position } from "./position";
import { SourceFork } from "./sourcefork";
import { SourceOperationResponse } from "./sourceoperationresponse";
import { Status } from "./status";
import { Expose, Type } from "class-transformer";

/**
 * Conveys a worker's progress through the work described by a WorkItem.
 */
export class WorkItemStatus extends SpeakeasyBase {
  /**
   * True if the WorkItem was completed (successfully or unsuccessfully).
   */
  @SpeakeasyMetadata()
  @Expose({ name: "completed" })
  completed?: boolean;

  /**
   * Worker output counters for this WorkItem.
   */
  @SpeakeasyMetadata({ elemType: CounterUpdate })
  @Expose({ name: "counterUpdates" })
  @Type(() => CounterUpdate)
  counterUpdates?: CounterUpdate[];

  /**
   * When a task splits using WorkItemStatus.dynamic_source_split, this message describes the two parts of the split relative to the description of the current task's input.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "dynamicSourceSplit" })
  @Type(() => DynamicSourceSplit)
  dynamicSourceSplit?: DynamicSourceSplit;

  /**
   * Specifies errors which occurred during processing. If errors are provided, and completed = true, then the WorkItem is considered to have failed.
   */
  @SpeakeasyMetadata({ elemType: Status })
  @Expose({ name: "errors" })
  @Type(() => Status)
  errors?: Status[];

  /**
   * DEPRECATED in favor of counter_updates.
   */
  @SpeakeasyMetadata({ elemType: MetricUpdate })
  @Expose({ name: "metricUpdates" })
  @Type(() => MetricUpdate)
  metricUpdates?: MetricUpdate[];

  /**
   * Obsolete in favor of ApproximateReportedProgress and ApproximateSplitRequest.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "progress" })
  @Type(() => ApproximateProgress)
  progress?: ApproximateProgress;

  /**
   * The report index. When a WorkItem is leased, the lease will contain an initial report index. When a WorkItem's status is reported to the system, the report should be sent with that report index, and the response will contain the index the worker should use for the next report. Reports received with unexpected index values will be rejected by the service. In order to preserve idempotency, the worker should not alter the contents of a report, even if the worker must submit the same report multiple times before getting back a response. The worker should not submit a subsequent report until the response for the previous report had been received from the service.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "reportIndex" })
  reportIndex?: string;

  /**
   * A progress measurement of a WorkItem by a worker.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "reportedProgress" })
  @Type(() => ApproximateReportedProgress)
  reportedProgress?: ApproximateReportedProgress;

  /**
   * Amount of time the worker requests for its lease.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "requestedLeaseDuration" })
  requestedLeaseDuration?: string;

  /**
   * DEPRECATED in favor of DynamicSourceSplit.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "sourceFork" })
  @Type(() => SourceFork)
  sourceFork?: SourceFork;

  /**
   * The result of a SourceOperationRequest, specified in ReportWorkItemStatusRequest.source_operation when the work item is completed.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "sourceOperationResponse" })
  @Type(() => SourceOperationResponse)
  sourceOperationResponse?: SourceOperationResponse;

  /**
   * Position defines a position within a collection of data. The value can be either the end position, a key (used with ordered collections), a byte offset, or a record index.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "stopPosition" })
  @Type(() => Position)
  stopPosition?: Position;

  /**
   * Total time the worker spent being throttled by external systems.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "totalThrottlerWaitTimeSeconds" })
  totalThrottlerWaitTimeSeconds?: number;

  /**
   * Identifies the WorkItem.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "workItemId" })
  workItemId?: string;
}
