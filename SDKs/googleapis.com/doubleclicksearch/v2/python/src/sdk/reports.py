"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

import requests as requests_http
from . import utils
from sdk.models import operations, shared
from typing import Any, Optional

class Reports:
    _client: requests_http.Session
    _security_client: requests_http.Session
    _server_url: str
    _language: str
    _sdk_version: str
    _gen_version: str

    def __init__(self, client: requests_http.Session, security_client: requests_http.Session, server_url: str, language: str, sdk_version: str, gen_version: str) -> None:
        self._client = client
        self._security_client = security_client
        self._server_url = server_url
        self._language = language
        self._sdk_version = sdk_version
        self._gen_version = gen_version
        
    def doubleclicksearch_reports_generate(self, request: operations.DoubleclicksearchReportsGenerateRequest, security: operations.DoubleclicksearchReportsGenerateSecurity) -> operations.DoubleclicksearchReportsGenerateResponse:
        r"""Generates and returns a report immediately."""
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/doubleclicksearch/v2/reports/generate'
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "report_request", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.DoubleclicksearchReportsGenerateRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('POST', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DoubleclicksearchReportsGenerateResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.Report])
                res.report = out

        return res

    def doubleclicksearch_reports_get(self, request: operations.DoubleclicksearchReportsGetRequest, security: operations.DoubleclicksearchReportsGetSecurity) -> operations.DoubleclicksearchReportsGetResponse:
        r"""Polls for the status of a report request."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.DoubleclicksearchReportsGetRequest, base_url, '/doubleclicksearch/v2/reports/{reportId}', request)
        
        query_params = utils.get_query_params(operations.DoubleclicksearchReportsGetRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DoubleclicksearchReportsGetResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.Report])
                res.report = out

        return res

    def doubleclicksearch_reports_get_file(self, request: operations.DoubleclicksearchReportsGetFileRequest, security: operations.DoubleclicksearchReportsGetFileSecurity) -> operations.DoubleclicksearchReportsGetFileResponse:
        r"""Downloads a report file encoded in UTF-8."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.DoubleclicksearchReportsGetFileRequest, base_url, '/doubleclicksearch/v2/reports/{reportId}/files/{reportFragment}', request)
        
        query_params = utils.get_query_params(operations.DoubleclicksearchReportsGetFileRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DoubleclicksearchReportsGetFileResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        

        return res

    def doubleclicksearch_reports_get_id_mapping_file(self, request: operations.DoubleclicksearchReportsGetIDMappingFileRequest, security: operations.DoubleclicksearchReportsGetIDMappingFileSecurity) -> operations.DoubleclicksearchReportsGetIDMappingFileResponse:
        r"""Downloads a csv file(encoded in UTF-8) that contains ID mappings between legacy SA360 and new SA360. The file includes all children entities of the given advertiser(e.g. engine accounts, campaigns, ad groups, etc.) that exist in both legacy SA360 and new SA360."""
        base_url = self._server_url
        
        url = utils.generate_url(operations.DoubleclicksearchReportsGetIDMappingFileRequest, base_url, '/doubleclicksearch/v2/agency/{agencyId}/advertiser/{advertiserId}/idmapping', request)
        
        query_params = utils.get_query_params(operations.DoubleclicksearchReportsGetIDMappingFileRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DoubleclicksearchReportsGetIDMappingFileResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[dict[str, Any]])
                res.id_mapping_file = out

        return res

    def doubleclicksearch_reports_request(self, request: operations.DoubleclicksearchReportsRequestRequest, security: operations.DoubleclicksearchReportsRequestSecurity) -> operations.DoubleclicksearchReportsRequestResponse:
        r"""Inserts a report request into the reporting system."""
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/doubleclicksearch/v2/reports'
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "report_request", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        query_params = utils.get_query_params(operations.DoubleclicksearchReportsRequestRequest, request)
        
        client = utils.configure_security_client(self._client, security)
        
        http_res = client.request('POST', url, params=query_params, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DoubleclicksearchReportsRequestResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.Report])
                res.report = out

        return res

    