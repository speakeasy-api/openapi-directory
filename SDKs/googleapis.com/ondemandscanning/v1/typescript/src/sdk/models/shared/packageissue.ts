/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { GrafeasV1FileLocation } from "./grafeasv1filelocation";
import { Version } from "./version";
import { Expose, Type } from "class-transformer";

/**
 * Output only. The distro or language system assigned severity for this vulnerability when that is available and note provider assigned severity when it is not available.
 */
export enum PackageIssueEffectiveSeverityEnum {
  SeverityUnspecified = "SEVERITY_UNSPECIFIED",
  Minimal = "MINIMAL",
  Low = "LOW",
  Medium = "MEDIUM",
  High = "HIGH",
  Critical = "CRITICAL",
}

/**
 * A detail for a distro and package this vulnerability occurrence was found in and its associated fix (if one is available).
 */
export class PackageIssue extends SpeakeasyBase {
  /**
   * Required. The [CPE URI](https://cpe.mitre.org/specification/) this vulnerability was found in.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "affectedCpeUri" })
  affectedCpeUri?: string;

  /**
   * Required. The package this vulnerability was found in.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "affectedPackage" })
  affectedPackage?: string;

  /**
   * Version contains structured information about the version of a package.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "affectedVersion" })
  @Type(() => Version)
  affectedVersion?: Version;

  /**
   * Output only. The distro or language system assigned severity for this vulnerability when that is available and note provider assigned severity when it is not available.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "effectiveSeverity" })
  effectiveSeverity?: PackageIssueEffectiveSeverityEnum;

  /**
   * The location at which this package was found.
   */
  @SpeakeasyMetadata({ elemType: GrafeasV1FileLocation })
  @Expose({ name: "fileLocation" })
  @Type(() => GrafeasV1FileLocation)
  fileLocation?: GrafeasV1FileLocation[];

  /**
   * Output only. Whether a fix is available for this package.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "fixAvailable" })
  fixAvailable?: boolean;

  /**
   * The [CPE URI](https://cpe.mitre.org/specification/) this vulnerability was fixed in. It is possible for this to be different from the affected_cpe_uri.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "fixedCpeUri" })
  fixedCpeUri?: string;

  /**
   * The package this vulnerability was fixed in. It is possible for this to be different from the affected_package.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "fixedPackage" })
  fixedPackage?: string;

  /**
   * Version contains structured information about the version of a package.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "fixedVersion" })
  @Type(() => Version)
  fixedVersion?: Version;

  /**
   * The type of package (e.g. OS, MAVEN, GO).
   */
  @SpeakeasyMetadata()
  @Expose({ name: "packageType" })
  packageType?: string;
}
