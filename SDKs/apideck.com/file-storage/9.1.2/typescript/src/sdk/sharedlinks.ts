/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import * as utils from "../internal/utils";
import * as operations from "./models/operations";
import * as shared from "./models/shared";
import { AxiosInstance, AxiosRequestConfig, AxiosResponse } from "axios";

/**
 * Shared links resource represents the links to files and folders in the cloud storage service that have been shared with other users. It provides methods for managing and accessing the shared links, such as creating, deleting, and listing shared links. A shared link allows other users to access the file or folder that it points to, either by viewing it online or by downloading it.
 */
export class SharedLinks {
  _defaultClient: AxiosInstance;
  _securityClient: AxiosInstance;
  _serverURL: string;
  _language: string;
  _sdkVersion: string;
  _genVersion: string;

  constructor(
    defaultClient: AxiosInstance,
    securityClient: AxiosInstance,
    serverURL: string,
    language: string,
    sdkVersion: string,
    genVersion: string
  ) {
    this._defaultClient = defaultClient;
    this._securityClient = securityClient;
    this._serverURL = serverURL;
    this._language = language;
    this._sdkVersion = sdkVersion;
    this._genVersion = genVersion;
  }

  /**
   * Create Shared Link
   *
   * @remarks
   * Create Shared Link
   */
  sharedLinksAdd(
    req: operations.SharedLinksAddRequest,
    security: operations.SharedLinksAddSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.SharedLinksAddResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.SharedLinksAddRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string =
      baseURL.replace(/\/$/, "") + "/file-storage/shared-links";

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "sharedLinkInput",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.SharedLinksAddSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = {
      ...utils.getHeadersFromRequest(req),
      ...reqBodyHeaders,
      ...config?.headers,
    };
    const queryParams: string = utils.serializeQueryParams(req);
    if (reqBody == null || Object.keys(reqBody).length === 0)
      throw new Error("request body is required");

    const r = client.request({
      url: url + queryParams,
      method: "post",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.SharedLinksAddResponse =
        new operations.SharedLinksAddResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 201:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.createSharedLinkResponse = utils.objectToClass(
              httpRes?.data,
              shared.CreateSharedLinkResponse
            );
          }
          break;
        case httpRes?.status == 400:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.badRequestResponse = utils.objectToClass(
              httpRes?.data,
              shared.BadRequestResponse
            );
          }
          break;
        case httpRes?.status == 401:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unauthorizedResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnauthorizedResponse
            );
          }
          break;
        case httpRes?.status == 402:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.paymentRequiredResponse = utils.objectToClass(
              httpRes?.data,
              shared.PaymentRequiredResponse
            );
          }
          break;
        case httpRes?.status == 404:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.notFoundResponse = utils.objectToClass(
              httpRes?.data,
              shared.NotFoundResponse
            );
          }
          break;
        case httpRes?.status == 422:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unprocessableResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnprocessableResponse
            );
          }
          break;
        default:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unexpectedErrorResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnexpectedErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * List SharedLinks
   *
   * @remarks
   * List SharedLinks
   */
  sharedLinksAll(
    req: operations.SharedLinksAllRequest,
    security: operations.SharedLinksAllSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.SharedLinksAllResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.SharedLinksAllRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string =
      baseURL.replace(/\/$/, "") + "/file-storage/shared-links";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.SharedLinksAllSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...utils.getHeadersFromRequest(req), ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      headers: headers,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.SharedLinksAllResponse =
        new operations.SharedLinksAllResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.getSharedLinksResponse = utils.objectToClass(
              httpRes?.data,
              shared.GetSharedLinksResponse
            );
          }
          break;
        case httpRes?.status == 400:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.badRequestResponse = utils.objectToClass(
              httpRes?.data,
              shared.BadRequestResponse
            );
          }
          break;
        case httpRes?.status == 401:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unauthorizedResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnauthorizedResponse
            );
          }
          break;
        case httpRes?.status == 402:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.paymentRequiredResponse = utils.objectToClass(
              httpRes?.data,
              shared.PaymentRequiredResponse
            );
          }
          break;
        case httpRes?.status == 404:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.notFoundResponse = utils.objectToClass(
              httpRes?.data,
              shared.NotFoundResponse
            );
          }
          break;
        case httpRes?.status == 422:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unprocessableResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnprocessableResponse
            );
          }
          break;
        default:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unexpectedErrorResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnexpectedErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Delete Shared Link
   *
   * @remarks
   * Delete Shared Link
   */
  sharedLinksDelete(
    req: operations.SharedLinksDeleteRequest,
    security: operations.SharedLinksDeleteSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.SharedLinksDeleteResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.SharedLinksDeleteRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/file-storage/shared-links/{id}",
      req
    );
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.SharedLinksDeleteSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...utils.getHeadersFromRequest(req), ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "delete",
      headers: headers,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.SharedLinksDeleteResponse =
        new operations.SharedLinksDeleteResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.deleteSharedLinkResponse = utils.objectToClass(
              httpRes?.data,
              shared.DeleteSharedLinkResponse
            );
          }
          break;
        case httpRes?.status == 400:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.badRequestResponse = utils.objectToClass(
              httpRes?.data,
              shared.BadRequestResponse
            );
          }
          break;
        case httpRes?.status == 401:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unauthorizedResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnauthorizedResponse
            );
          }
          break;
        case httpRes?.status == 402:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.paymentRequiredResponse = utils.objectToClass(
              httpRes?.data,
              shared.PaymentRequiredResponse
            );
          }
          break;
        case httpRes?.status == 404:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.notFoundResponse = utils.objectToClass(
              httpRes?.data,
              shared.NotFoundResponse
            );
          }
          break;
        case httpRes?.status == 422:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unprocessableResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnprocessableResponse
            );
          }
          break;
        default:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unexpectedErrorResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnexpectedErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Get Shared Link
   *
   * @remarks
   * Get Shared Link
   */
  sharedLinksOne(
    req: operations.SharedLinksOneRequest,
    security: operations.SharedLinksOneSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.SharedLinksOneResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.SharedLinksOneRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/file-storage/shared-links/{id}",
      req
    );
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.SharedLinksOneSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...utils.getHeadersFromRequest(req), ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      headers: headers,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.SharedLinksOneResponse =
        new operations.SharedLinksOneResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.getSharedLinkResponse = utils.objectToClass(
              httpRes?.data,
              shared.GetSharedLinkResponseOutput
            );
          }
          break;
        case httpRes?.status == 400:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.badRequestResponse = utils.objectToClass(
              httpRes?.data,
              shared.BadRequestResponse
            );
          }
          break;
        case httpRes?.status == 401:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unauthorizedResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnauthorizedResponse
            );
          }
          break;
        case httpRes?.status == 402:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.paymentRequiredResponse = utils.objectToClass(
              httpRes?.data,
              shared.PaymentRequiredResponse
            );
          }
          break;
        case httpRes?.status == 404:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.notFoundResponse = utils.objectToClass(
              httpRes?.data,
              shared.NotFoundResponse
            );
          }
          break;
        case httpRes?.status == 422:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unprocessableResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnprocessableResponse
            );
          }
          break;
        default:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unexpectedErrorResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnexpectedErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Update Shared Link
   *
   * @remarks
   * Update Shared Link
   */
  sharedLinksUpdate(
    req: operations.SharedLinksUpdateRequest,
    security: operations.SharedLinksUpdateSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.SharedLinksUpdateResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.SharedLinksUpdateRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/file-storage/shared-links/{id}",
      req
    );

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "sharedLinkInput",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.SharedLinksUpdateSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = {
      ...utils.getHeadersFromRequest(req),
      ...reqBodyHeaders,
      ...config?.headers,
    };
    const queryParams: string = utils.serializeQueryParams(req);
    if (reqBody == null || Object.keys(reqBody).length === 0)
      throw new Error("request body is required");

    const r = client.request({
      url: url + queryParams,
      method: "patch",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.SharedLinksUpdateResponse =
        new operations.SharedLinksUpdateResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.updateSharedLinkResponse = utils.objectToClass(
              httpRes?.data,
              shared.UpdateSharedLinkResponse
            );
          }
          break;
        case httpRes?.status == 400:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.badRequestResponse = utils.objectToClass(
              httpRes?.data,
              shared.BadRequestResponse
            );
          }
          break;
        case httpRes?.status == 401:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unauthorizedResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnauthorizedResponse
            );
          }
          break;
        case httpRes?.status == 402:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.paymentRequiredResponse = utils.objectToClass(
              httpRes?.data,
              shared.PaymentRequiredResponse
            );
          }
          break;
        case httpRes?.status == 404:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.notFoundResponse = utils.objectToClass(
              httpRes?.data,
              shared.NotFoundResponse
            );
          }
          break;
        case httpRes?.status == 422:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unprocessableResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnprocessableResponse
            );
          }
          break;
        default:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.unexpectedErrorResponse = utils.objectToClass(
              httpRes?.data,
              shared.UnexpectedErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }
}
