// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
)

// PostureDetailSecurityRiskEnum - A specific security risk that negatively affects the security posture of the device.
type PostureDetailSecurityRiskEnum string

const (
	PostureDetailSecurityRiskEnumSecurityRiskUnspecified        PostureDetailSecurityRiskEnum = "SECURITY_RISK_UNSPECIFIED"
	PostureDetailSecurityRiskEnumUnknownOs                      PostureDetailSecurityRiskEnum = "UNKNOWN_OS"
	PostureDetailSecurityRiskEnumCompromisedOs                  PostureDetailSecurityRiskEnum = "COMPROMISED_OS"
	PostureDetailSecurityRiskEnumHardwareBackedEvaluationFailed PostureDetailSecurityRiskEnum = "HARDWARE_BACKED_EVALUATION_FAILED"
)

func (e PostureDetailSecurityRiskEnum) ToPointer() *PostureDetailSecurityRiskEnum {
	return &e
}

func (e *PostureDetailSecurityRiskEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "SECURITY_RISK_UNSPECIFIED":
		fallthrough
	case "UNKNOWN_OS":
		fallthrough
	case "COMPROMISED_OS":
		fallthrough
	case "HARDWARE_BACKED_EVALUATION_FAILED":
		*e = PostureDetailSecurityRiskEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for PostureDetailSecurityRiskEnum: %v", v)
	}
}

// PostureDetail - Additional details regarding the security posture of the device.
type PostureDetail struct {
	// Corresponding admin-facing advice to mitigate this security risk and improve the security posture of the device.
	Advice []UserFacingMessage `json:"advice,omitempty"`
	// A specific security risk that negatively affects the security posture of the device.
	SecurityRisk *PostureDetailSecurityRiskEnum `json:"securityRisk,omitempty"`
}
