"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

import requests as requests_http
from . import utils
from sdk.models import operations, shared
from typing import Optional

class Batches:
    r"""batches"""
    _client: requests_http.Session
    _security_client: requests_http.Session
    _server_url: str
    _language: str
    _sdk_version: str
    _gen_version: str

    def __init__(self, client: requests_http.Session, security_client: requests_http.Session, server_url: str, language: str, sdk_version: str, gen_version: str) -> None:
        self._client = client
        self._security_client = security_client
        self._server_url = server_url
        self._language = language
        self._sdk_version = sdk_version
        self._gen_version = gen_version
        
    def add_to_batch(self, request: operations.AddToBatchRequest) -> operations.AddToBatchResponse:
        r"""Add to a Batch
        Add a Shipment or Rate to a Batch
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.AddToBatchRequest, base_url, '/v1/batches/{batch_id}/add', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "add_to_batch_request_body", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        if data is None and form is None:
            raise Exception('request body is required')
        
        client = self._security_client
        
        http_res = client.request('POST', url, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.AddToBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 204:
            if utils.match_content_type(content_type, 'application/json'):
                res.empty_response_body = http_res.content
            if utils.match_content_type(content_type, 'text/plain'):
                res.empty_response_body = http_res.content
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def create_batch(self, request: shared.CreateBatchRequestBody) -> operations.CreateBatchResponse:
        r"""Create A Batch
        Create a Batch
        """
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/batches'
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "request", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        if data is None and form is None:
            raise Exception('request body is required')
        
        client = self._security_client
        
        http_res = client.request('POST', url, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CreateBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.CreateBatchResponseBody])
                res.create_batch_response_body = out
        elif http_res.status_code in [400, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def delete_batch(self, request: operations.DeleteBatchRequest) -> operations.DeleteBatchResponse:
        r"""Delete Batch By Id
        Delete Batch By Id
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.DeleteBatchRequest, base_url, '/v1/batches/{batch_id}', request)
        
        
        client = self._security_client
        
        http_res = client.request('DELETE', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.DeleteBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 204:
            if utils.match_content_type(content_type, 'application/json'):
                res.empty_response_body = http_res.content
            if utils.match_content_type(content_type, 'text/plain'):
                res.empty_response_body = http_res.content
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def get_batch_by_external_id(self, request: operations.GetBatchByExternalIDRequest) -> operations.GetBatchByExternalIDResponse:
        r"""Get Batch By External ID
        Get Batch By External ID
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.GetBatchByExternalIDRequest, base_url, '/v1/batches/external_batch_id/{external_batch_id}', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetBatchByExternalIDResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.GetBatchByExternalIDResponseBody])
                res.get_batch_by_external_id_response_body = out
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def get_batch_by_id(self, request: operations.GetBatchByIDRequest) -> operations.GetBatchByIDResponse:
        r"""Get Batch By ID
        Get Batch By ID
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.GetBatchByIDRequest, base_url, '/v1/batches/{batch_id}', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetBatchByIDResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.GetBatchByIDResponseBody])
                res.get_batch_by_id_response_body = out
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def list_batch_errors(self, request: operations.ListBatchErrorsRequest) -> operations.ListBatchErrorsResponse:
        r"""Get Batch Errors
        Error handling in batches are handled differently than in a single synchronous request.
        You must retrieve the status of your batch by [getting a batch](https://www.shipengine.com/docs/reference/get-batch-by-id/) and getting an overview of the statuses or you can list errors directly here below to get detailed information about the errors.
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ListBatchErrorsRequest, base_url, '/v1/batches/{batch_id}/errors', request)
        
        query_params = utils.get_query_params(operations.ListBatchErrorsRequest, request)
        
        client = self._security_client
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ListBatchErrorsResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ListBatchErrorsResponseBody])
                res.list_batch_errors_response_body = out
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def list_batches(self, request: operations.ListBatchesRequest) -> operations.ListBatchesResponse:
        r"""List Batches
        List Batches associated with your Shipengine account
        """
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/batches'
        
        query_params = utils.get_query_params(operations.ListBatchesRequest, request)
        
        client = self._security_client
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ListBatchesResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ListBatchesResponseBody])
                res.list_batches_response_body = out
        elif http_res.status_code in [404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def process_batch(self, request: operations.ProcessBatchRequest) -> operations.ProcessBatchResponse:
        r"""Process Batch ID Labels
        Process Batch ID Labels
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ProcessBatchRequest, base_url, '/v1/batches/{batch_id}/process/labels', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "process_batch_request_body", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        if data is None and form is None:
            raise Exception('request body is required')
        
        client = self._security_client
        
        http_res = client.request('POST', url, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ProcessBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 204:
            if utils.match_content_type(content_type, 'application/json'):
                res.empty_response_body = http_res.content
            if utils.match_content_type(content_type, 'text/plain'):
                res.empty_response_body = http_res.content
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def remove_from_batch(self, request: operations.RemoveFromBatchRequest) -> operations.RemoveFromBatchResponse:
        r"""Remove From Batch
        Remove a shipment or rate from a batch
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.RemoveFromBatchRequest, base_url, '/v1/batches/{batch_id}/remove', request)
        
        headers = {}
        req_content_type, data, form = utils.serialize_request_body(request, "remove_from_batch_request_body", 'json')
        if req_content_type not in ('multipart/form-data', 'multipart/mixed'):
            headers['content-type'] = req_content_type
        if data is None and form is None:
            raise Exception('request body is required')
        
        client = self._security_client
        
        http_res = client.request('POST', url, data=data, files=form, headers=headers)
        content_type = http_res.headers.get('Content-Type')

        res = operations.RemoveFromBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 204:
            if utils.match_content_type(content_type, 'application/json'):
                res.empty_response_body = http_res.content
            if utils.match_content_type(content_type, 'text/plain'):
                res.empty_response_body = http_res.content
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    def update_batch(self, request: operations.UpdateBatchRequest) -> operations.UpdateBatchResponse:
        r"""Update Batch By Id
        Update Batch By Id
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.UpdateBatchRequest, base_url, '/v1/batches/{batch_id}', request)
        
        
        client = self._security_client
        
        http_res = client.request('PUT', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.UpdateBatchResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 204:
            if utils.match_content_type(content_type, 'application/json'):
                res.empty_response_body = http_res.content
            if utils.match_content_type(content_type, 'text/plain'):
                res.empty_response_body = http_res.content
        elif http_res.status_code in [400, 404, 500]:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[shared.ErrorResponseBody])
                res.error_response_body = out

        return res

    