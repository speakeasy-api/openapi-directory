/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { PackageVulnerabilityDetails } from "./packagevulnerabilitydetails";
import { Remediation } from "./remediation";
import { Resource } from "./resource";
import { ScoreDetails } from "./scoredetails";
import { Expose, Transform, Type } from "class-transformer";

/**
 * The details of an enhanced image scan. This is returned when enhanced scanning is enabled for your private registry.
 */
export class EnhancedImageScanFinding extends SpeakeasyBase {
  @SpeakeasyMetadata()
  @Expose({ name: "awsAccountId" })
  awsAccountId?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "description" })
  description?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "findingArn" })
  findingArn?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "firstObservedAt" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  firstObservedAt?: Date;

  @SpeakeasyMetadata()
  @Expose({ name: "lastObservedAt" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  lastObservedAt?: Date;

  @SpeakeasyMetadata()
  @Expose({ name: "packageVulnerabilityDetails" })
  @Type(() => PackageVulnerabilityDetails)
  packageVulnerabilityDetails?: PackageVulnerabilityDetails;

  @SpeakeasyMetadata()
  @Expose({ name: "remediation" })
  @Type(() => Remediation)
  remediation?: Remediation;

  @SpeakeasyMetadata({ elemType: Resource })
  @Expose({ name: "resources" })
  @Type(() => Resource)
  resources?: Resource[];

  @SpeakeasyMetadata()
  @Expose({ name: "score" })
  score?: number;

  @SpeakeasyMetadata()
  @Expose({ name: "scoreDetails" })
  @Type(() => ScoreDetails)
  scoreDetails?: ScoreDetails;

  @SpeakeasyMetadata()
  @Expose({ name: "severity" })
  severity?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "status" })
  status?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "title" })
  title?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "type" })
  type?: string;

  @SpeakeasyMetadata()
  @Expose({ name: "updatedAt" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  updatedAt?: Date;
}
