// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
)

// ImportJobImportMethodEnum - Required. Immutable. The wrapping method to be used for incoming key material.
type ImportJobImportMethodEnum string

const (
	ImportJobImportMethodEnumImportMethodUnspecified ImportJobImportMethodEnum = "IMPORT_METHOD_UNSPECIFIED"
	ImportJobImportMethodEnumRsaOaep3072Sha1Aes256   ImportJobImportMethodEnum = "RSA_OAEP_3072_SHA1_AES_256"
	ImportJobImportMethodEnumRsaOaep4096Sha1Aes256   ImportJobImportMethodEnum = "RSA_OAEP_4096_SHA1_AES_256"
	ImportJobImportMethodEnumRsaOaep3072Sha256Aes256 ImportJobImportMethodEnum = "RSA_OAEP_3072_SHA256_AES_256"
	ImportJobImportMethodEnumRsaOaep4096Sha256Aes256 ImportJobImportMethodEnum = "RSA_OAEP_4096_SHA256_AES_256"
	ImportJobImportMethodEnumRsaOaep3072Sha256       ImportJobImportMethodEnum = "RSA_OAEP_3072_SHA256"
	ImportJobImportMethodEnumRsaOaep4096Sha256       ImportJobImportMethodEnum = "RSA_OAEP_4096_SHA256"
)

func (e ImportJobImportMethodEnum) ToPointer() *ImportJobImportMethodEnum {
	return &e
}

func (e *ImportJobImportMethodEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "IMPORT_METHOD_UNSPECIFIED":
		fallthrough
	case "RSA_OAEP_3072_SHA1_AES_256":
		fallthrough
	case "RSA_OAEP_4096_SHA1_AES_256":
		fallthrough
	case "RSA_OAEP_3072_SHA256_AES_256":
		fallthrough
	case "RSA_OAEP_4096_SHA256_AES_256":
		fallthrough
	case "RSA_OAEP_3072_SHA256":
		fallthrough
	case "RSA_OAEP_4096_SHA256":
		*e = ImportJobImportMethodEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for ImportJobImportMethodEnum: %v", v)
	}
}

// ImportJobProtectionLevelEnum - Required. Immutable. The protection level of the ImportJob. This must match the protection_level of the version_template on the CryptoKey you attempt to import into.
type ImportJobProtectionLevelEnum string

const (
	ImportJobProtectionLevelEnumProtectionLevelUnspecified ImportJobProtectionLevelEnum = "PROTECTION_LEVEL_UNSPECIFIED"
	ImportJobProtectionLevelEnumSoftware                   ImportJobProtectionLevelEnum = "SOFTWARE"
	ImportJobProtectionLevelEnumHsm                        ImportJobProtectionLevelEnum = "HSM"
	ImportJobProtectionLevelEnumExternal                   ImportJobProtectionLevelEnum = "EXTERNAL"
	ImportJobProtectionLevelEnumExternalVpc                ImportJobProtectionLevelEnum = "EXTERNAL_VPC"
)

func (e ImportJobProtectionLevelEnum) ToPointer() *ImportJobProtectionLevelEnum {
	return &e
}

func (e *ImportJobProtectionLevelEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "PROTECTION_LEVEL_UNSPECIFIED":
		fallthrough
	case "SOFTWARE":
		fallthrough
	case "HSM":
		fallthrough
	case "EXTERNAL":
		fallthrough
	case "EXTERNAL_VPC":
		*e = ImportJobProtectionLevelEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for ImportJobProtectionLevelEnum: %v", v)
	}
}

// ImportJobStateEnum - Output only. The current state of the ImportJob, indicating if it can be used.
type ImportJobStateEnum string

const (
	ImportJobStateEnumImportJobStateUnspecified ImportJobStateEnum = "IMPORT_JOB_STATE_UNSPECIFIED"
	ImportJobStateEnumPendingGeneration         ImportJobStateEnum = "PENDING_GENERATION"
	ImportJobStateEnumActive                    ImportJobStateEnum = "ACTIVE"
	ImportJobStateEnumExpired                   ImportJobStateEnum = "EXPIRED"
)

func (e ImportJobStateEnum) ToPointer() *ImportJobStateEnum {
	return &e
}

func (e *ImportJobStateEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "IMPORT_JOB_STATE_UNSPECIFIED":
		fallthrough
	case "PENDING_GENERATION":
		fallthrough
	case "ACTIVE":
		fallthrough
	case "EXPIRED":
		*e = ImportJobStateEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for ImportJobStateEnum: %v", v)
	}
}

// ImportJob - An ImportJob can be used to create CryptoKeys and CryptoKeyVersions using pre-existing key material, generated outside of Cloud KMS. When an ImportJob is created, Cloud KMS will generate a "wrapping key", which is a public/private key pair. You use the wrapping key to encrypt (also known as wrap) the pre-existing key material to protect it during the import process. The nature of the wrapping key depends on the choice of import_method. When the wrapping key generation is complete, the state will be set to ACTIVE and the public_key can be fetched. The fetched public key can then be used to wrap your pre-existing key material. Once the key material is wrapped, it can be imported into a new CryptoKeyVersion in an existing CryptoKey by calling ImportCryptoKeyVersion. Multiple CryptoKeyVersions can be imported with a single ImportJob. Cloud KMS uses the private key portion of the wrapping key to unwrap the key material. Only Cloud KMS has access to the private key. An ImportJob expires 3 days after it is created. Once expired, Cloud KMS will no longer be able to import or unwrap any key material that was wrapped with the ImportJob's public key. For more information, see [Importing a key](https://cloud.google.com/kms/docs/importing-a-key).
type ImportJob struct {
	// Contains an HSM-generated attestation about a key operation. For more information, see [Verifying attestations] (https://cloud.google.com/kms/docs/attest-key).
	Attestation *KeyOperationAttestation `json:"attestation,omitempty"`
	// Output only. The time at which this ImportJob was created.
	CreateTime *string `json:"createTime,omitempty"`
	// Output only. The time this ImportJob expired. Only present if state is EXPIRED.
	ExpireEventTime *string `json:"expireEventTime,omitempty"`
	// Output only. The time at which this ImportJob is scheduled for expiration and can no longer be used to import key material.
	ExpireTime *string `json:"expireTime,omitempty"`
	// Output only. The time this ImportJob's key material was generated.
	GenerateTime *string `json:"generateTime,omitempty"`
	// Required. Immutable. The wrapping method to be used for incoming key material.
	ImportMethod *ImportJobImportMethodEnum `json:"importMethod,omitempty"`
	// Output only. The resource name for this ImportJob in the format `projects/*/locations/*/keyRings/*/importJobs/*`.
	Name *string `json:"name,omitempty"`
	// Required. Immutable. The protection level of the ImportJob. This must match the protection_level of the version_template on the CryptoKey you attempt to import into.
	ProtectionLevel *ImportJobProtectionLevelEnum `json:"protectionLevel,omitempty"`
	// The public key component of the wrapping key. For details of the type of key this public key corresponds to, see the ImportMethod.
	PublicKey *WrappingPublicKey `json:"publicKey,omitempty"`
	// Output only. The current state of the ImportJob, indicating if it can be used.
	State *ImportJobStateEnum `json:"state,omitempty"`
}

// ImportJobInput - An ImportJob can be used to create CryptoKeys and CryptoKeyVersions using pre-existing key material, generated outside of Cloud KMS. When an ImportJob is created, Cloud KMS will generate a "wrapping key", which is a public/private key pair. You use the wrapping key to encrypt (also known as wrap) the pre-existing key material to protect it during the import process. The nature of the wrapping key depends on the choice of import_method. When the wrapping key generation is complete, the state will be set to ACTIVE and the public_key can be fetched. The fetched public key can then be used to wrap your pre-existing key material. Once the key material is wrapped, it can be imported into a new CryptoKeyVersion in an existing CryptoKey by calling ImportCryptoKeyVersion. Multiple CryptoKeyVersions can be imported with a single ImportJob. Cloud KMS uses the private key portion of the wrapping key to unwrap the key material. Only Cloud KMS has access to the private key. An ImportJob expires 3 days after it is created. Once expired, Cloud KMS will no longer be able to import or unwrap any key material that was wrapped with the ImportJob's public key. For more information, see [Importing a key](https://cloud.google.com/kms/docs/importing-a-key).
type ImportJobInput struct {
	// Contains an HSM-generated attestation about a key operation. For more information, see [Verifying attestations] (https://cloud.google.com/kms/docs/attest-key).
	Attestation *KeyOperationAttestationInput `json:"attestation,omitempty"`
	// Required. Immutable. The wrapping method to be used for incoming key material.
	ImportMethod *ImportJobImportMethodEnum `json:"importMethod,omitempty"`
	// Required. Immutable. The protection level of the ImportJob. This must match the protection_level of the version_template on the CryptoKey you attempt to import into.
	ProtectionLevel *ImportJobProtectionLevelEnum `json:"protectionLevel,omitempty"`
	// The public key component of the wrapping key. For details of the type of key this public key corresponds to, see the ImportMethod.
	PublicKey *WrappingPublicKey `json:"publicKey,omitempty"`
}
