// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"bytes"
	"encoding/json"
	"errors"
	"fmt"
)

type UpdateTemplateRequestFieldsType string

const (
	UpdateTemplateRequestFieldsTypeCheck UpdateTemplateRequestFieldsType = "check"
	UpdateTemplateRequestFieldsTypeDate  UpdateTemplateRequestFieldsType = "date"
	UpdateTemplateRequestFieldsTypeImage UpdateTemplateRequestFieldsType = "image"
	UpdateTemplateRequestFieldsTypeText  UpdateTemplateRequestFieldsType = "text"
)

type UpdateTemplateRequestFields struct {
	DateField     *DateField
	TextField     *TextField
	ImageField    *ImageField
	CheckBoxField *CheckBoxField

	Type UpdateTemplateRequestFieldsType
}

func CreateUpdateTemplateRequestFieldsCheck(check CheckBoxField) UpdateTemplateRequestFields {
	typ := UpdateTemplateRequestFieldsTypeCheck
	typStr := CheckBoxFieldTypeEnum(typ)
	check.Type = typStr

	return UpdateTemplateRequestFields{
		CheckBoxField: &check,
		Type:          typ,
	}
}

func CreateUpdateTemplateRequestFieldsDate(date DateField) UpdateTemplateRequestFields {
	typ := UpdateTemplateRequestFieldsTypeDate
	typStr := DateFieldTypeEnum(typ)
	date.Type = typStr

	return UpdateTemplateRequestFields{
		DateField: &date,
		Type:      typ,
	}
}

func CreateUpdateTemplateRequestFieldsImage(image ImageField) UpdateTemplateRequestFields {
	typ := UpdateTemplateRequestFieldsTypeImage
	typStr := ImageFieldTypeEnum(typ)
	image.Type = &typStr

	return UpdateTemplateRequestFields{
		ImageField: &image,
		Type:       typ,
	}
}

func CreateUpdateTemplateRequestFieldsText(text TextField) UpdateTemplateRequestFields {
	typ := UpdateTemplateRequestFieldsTypeText
	typStr := TextFieldTypeEnum(typ)
	text.Type = typStr

	return UpdateTemplateRequestFields{
		TextField: &text,
		Type:      typ,
	}
}

func (u *UpdateTemplateRequestFields) UnmarshalJSON(data []byte) error {
	var d *json.Decoder

	type discriminator struct {
		Type string
	}

	dis := new(discriminator)
	if err := json.Unmarshal(data, &dis); err != nil {
		return fmt.Errorf("could not unmarshal discriminator: %w", err)
	}

	switch dis.Type {
	case "check":
		d = json.NewDecoder(bytes.NewReader(data))
		d.DisallowUnknownFields()
		checkBoxField := new(CheckBoxField)
		if err := d.Decode(&checkBoxField); err != nil {
			return fmt.Errorf("could not unmarshal expected type: %w", err)
		}

		u.CheckBoxField = checkBoxField
		u.Type = UpdateTemplateRequestFieldsTypeCheck
		return nil
	case "date":
		d = json.NewDecoder(bytes.NewReader(data))
		d.DisallowUnknownFields()
		dateField := new(DateField)
		if err := d.Decode(&dateField); err != nil {
			return fmt.Errorf("could not unmarshal expected type: %w", err)
		}

		u.DateField = dateField
		u.Type = UpdateTemplateRequestFieldsTypeDate
		return nil
	case "image":
		d = json.NewDecoder(bytes.NewReader(data))
		d.DisallowUnknownFields()
		imageField := new(ImageField)
		if err := d.Decode(&imageField); err != nil {
			return fmt.Errorf("could not unmarshal expected type: %w", err)
		}

		u.ImageField = imageField
		u.Type = UpdateTemplateRequestFieldsTypeImage
		return nil
	case "text":
		d = json.NewDecoder(bytes.NewReader(data))
		d.DisallowUnknownFields()
		textField := new(TextField)
		if err := d.Decode(&textField); err != nil {
			return fmt.Errorf("could not unmarshal expected type: %w", err)
		}

		u.TextField = textField
		u.Type = UpdateTemplateRequestFieldsTypeText
		return nil
	}

	return errors.New("could not unmarshal into supported union types")
}

func (u UpdateTemplateRequestFields) MarshalJSON() ([]byte, error) {
	if u.DateField != nil {
		return json.Marshal(u.DateField)
	}

	if u.TextField != nil {
		return json.Marshal(u.TextField)
	}

	if u.ImageField != nil {
		return json.Marshal(u.ImageField)
	}

	if u.CheckBoxField != nil {
		return json.Marshal(u.CheckBoxField)
	}

	return nil, nil
}

type UpdateTemplateRequest struct {
	Fields []UpdateTemplateRequestFields `json:"fields"`
	Name   *string                       `json:"name,omitempty"`
}
