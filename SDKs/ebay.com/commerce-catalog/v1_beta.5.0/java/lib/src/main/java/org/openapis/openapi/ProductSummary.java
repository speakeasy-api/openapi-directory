/* 
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

package org.openapis.openapi;

import com.fasterxml.jackson.databind.ObjectMapper;
import java.net.http.HttpResponse;
import java.nio.charset.StandardCharsets;
import org.apache.http.NameValuePair;
import org.openapis.openapi.utils.HTTPClient;
import org.openapis.openapi.utils.HTTPRequest;
import org.openapis.openapi.utils.JSON;

public class ProductSummary {
	
	private HTTPClient _defaultClient;
	private HTTPClient _securityClient;
	private String _serverUrl;
	private String _language;
	private String _sdkVersion;
	private String _genVersion;

	public ProductSummary(HTTPClient defaultClient, HTTPClient securityClient, String serverUrl, String language, String sdkVersion, String genVersion) {
		this._defaultClient = defaultClient;
		this._securityClient = securityClient;
		this._serverUrl = serverUrl;
		this._language = language;
		this._sdkVersion = sdkVersion;
		this._genVersion = genVersion;
	}

    /**
     * This method searches for and retrieves summaries of one or more products in the eBay catalog that match the search criteria provided by a seller. The seller can use the summaries to select the product in the eBay catalog that corresponds to the item that the seller wants to offer for sale. When a corresponding product is found and adopted by the seller, eBay will use the product information to populate the item listing. The criteria supported by &lt;b&gt;search&lt;/b&gt; include keywords, product categories, and category aspects. To see the full details of a selected product, use the &lt;b&gt;getProduct&lt;/b&gt; call. &lt;br /&gt;&lt;br /&gt; In addition to product summaries, this method can also be used to identify &lt;i&gt;refinements&lt;/i&gt;, which help you to better pinpoint the product you're looking for. A refinement consists of one or more &lt;i&gt;aspect&lt;/i&gt; values and a count of the number of times that each value has been used in previous eBay listings. An aspect is a property (e.g. color or size) of an eBay category, used by sellers to provide details about the items they're listing. The &lt;b&gt;refinement&lt;/b&gt; container is returned when you include the &lt;b&gt;fieldGroups&lt;/b&gt; query parameter in the request with a value of &lt;code&gt;ASPECT_REFINEMENTS&lt;/code&gt; or &lt;code&gt;FULL&lt;/code&gt;. &lt;br /&gt;&lt;br /&gt; &lt;span style="padding: 15px 20px; display: block; border: 1px solid #cccccc"&gt;&lt;b&gt;Example&lt;/b&gt; &lt;br /&gt;A seller wants to find a product that is "gray" in color, but doesn't know what term the manufacturer uses for that color. It might be &lt;code&gt;Silver&lt;/code&gt;, &lt;code&gt;Brushed Nickel&lt;/code&gt;, &lt;code&gt;Pewter&lt;/code&gt;, or even &lt;code&gt;Grey&lt;/code&gt;. The returned &lt;b&gt;refinement&lt;/b&gt; container identifies all aspects that have been used in past listings for products that match your search criteria, along with all of the values those aspects have taken, and the number of times each value was used. You can use this data to present the seller with a histogram of the values of each aspect. The seller can see which color values have been used in the past, and how frequently they have been used, and selects the most likely value or values for their product. You issue the &lt;b&gt;search&lt;/b&gt; method again with those values in the &lt;b&gt;aspect_filter&lt;/b&gt; parameter to narrow down the collection of products returned by the call.&lt;/span&gt; &lt;br /&gt;&lt;br /&gt; Although all query parameters are optional, this method must include at least the &lt;b&gt;q&lt;/b&gt; parameter, or the &lt;b&gt;category_ids&lt;/b&gt;, &lt;b&gt;gtin&lt;/b&gt;, or &lt;b&gt;mpn&lt;/b&gt; parameter with a valid value. If you provide more than one of these parameters, they will be combined with a logical AND to further refine the returned collection of matching products. &lt;br /&gt;&lt;br /&gt; &lt;span class="tablenote"&gt;&lt;strong&gt;Note:&lt;/strong&gt; This method requires that certain special characters in the query parameters be percent-encoded: &lt;br /&gt;&lt;br /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;(space)&lt;/code&gt; = &lt;code&gt;%20&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;,&lt;/code&gt; = &lt;code&gt;%2C&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;:&lt;/code&gt; = &lt;code&gt;%3A&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;[&lt;/code&gt; = &lt;code&gt;%5B&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;]&lt;/code&gt; = &lt;code&gt;%5D&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;{&lt;/code&gt; = &lt;code&gt;%7B&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;|&lt;/code&gt; = &lt;code&gt;%7C&lt;/code&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;code&gt;}&lt;/code&gt; = &lt;code&gt;%7D&lt;/code&gt; &lt;br /&gt;&lt;br /&gt; This requirement applies to all query parameter values. However, for readability, method examples and samples in this documentation will not use the encoding.&lt;/span&gt; &lt;br /&gt;&lt;br /&gt; This method returns product summaries rather than the full details of the products. To retrieve the full details of a product, use the &lt;b&gt;getProduct&lt;/b&gt; method with an ePID.
     * @param request the request object containing all of the parameters for the API call
     * @param security the security details to use for authentication
     * @return the response from the API call
     * @throws Exception if the API call fails
     */
    public org.openapis.openapi.models.operations.SearchResponse search(org.openapis.openapi.models.operations.SearchRequest request, org.openapis.openapi.models.operations.SearchSecurity security) throws Exception {
        String baseUrl = this._serverUrl;
        String url = org.openapis.openapi.utils.Utils.generateURL(baseUrl, "/product_summary/search");
        
        HTTPRequest req = new HTTPRequest();
        req.setMethod("GET");
        req.setURL(url);
        
        java.util.List<NameValuePair> queryParams = org.openapis.openapi.utils.Utils.getQueryParams(org.openapis.openapi.models.operations.SearchRequest.class, request, null);
        if (queryParams != null) {
            for (NameValuePair queryParam : queryParams) {
                req.addQueryParam(queryParam);
            }
        }
        java.util.Map<String, java.util.List<String>> headers = org.openapis.openapi.utils.Utils.getHeaders(request);
        if (headers != null) {
            for (java.util.Map.Entry<String, java.util.List<String>> header : headers.entrySet()) {
                for (String value : header.getValue()) {
                    req.addHeader(header.getKey(), value);
                }
            }
        }
        
        HTTPClient client = org.openapis.openapi.utils.Utils.configureSecurityClient(this._defaultClient, security);
        
        HttpResponse<byte[]> httpRes = client.send(req);

        String contentType = httpRes.headers().firstValue("Content-Type").orElse("application/octet-stream");

        org.openapis.openapi.models.operations.SearchResponse res = new org.openapis.openapi.models.operations.SearchResponse(contentType, httpRes.statusCode()) {{
            productSearchResponse = null;
        }};
        res.rawResponse = httpRes;
        
        if (httpRes.statusCode() == 200) {
            if (org.openapis.openapi.utils.Utils.matchContentType(contentType, "application/json")) {
                ObjectMapper mapper = JSON.getMapper();
                org.openapis.openapi.models.shared.ProductSearchResponse out = mapper.readValue(new String(httpRes.body(), StandardCharsets.UTF_8), org.openapis.openapi.models.shared.ProductSearchResponse.class);
                res.productSearchResponse = out;
            }
        }
        else if (httpRes.statusCode() == 204 || httpRes.statusCode() == 400 || httpRes.statusCode() == 403 || httpRes.statusCode() == 500) {
        }

        return res;
    }
}