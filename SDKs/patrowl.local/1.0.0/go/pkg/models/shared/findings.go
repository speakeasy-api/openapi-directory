// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package shared

import (
	"encoding/json"
	"fmt"
	"time"
)

type FindingsMetaRisk struct {
	CvssBaseScore        []string `json:"cvss_base_score,omitempty"`
	CvssVector           []string `json:"cvss_vector,omitempty"`
	ExploitAvailable     []string `json:"exploit_available,omitempty"`
	ExploitabilityEase   []string `json:"exploitability_ease,omitempty"`
	PatchPublicationDate []string `json:"patch_publication_date,omitempty"`
}

type FindingsMetaVulnRefs struct {
	Bid []string `json:"bid,omitempty"`
	Cpe []string `json:"cpe,omitempty"`
	Cve []string `json:"cve,omitempty"`
	Cwe []string `json:"cwe,omitempty"`
}

type FindingsSeverityEnum string

const (
	FindingsSeverityEnumInfo   FindingsSeverityEnum = "info"
	FindingsSeverityEnumLow    FindingsSeverityEnum = "low"
	FindingsSeverityEnumMedium FindingsSeverityEnum = "medium"
	FindingsSeverityEnumHigh   FindingsSeverityEnum = "high"
)

func (e FindingsSeverityEnum) ToPointer() *FindingsSeverityEnum {
	return &e
}

func (e *FindingsSeverityEnum) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "info":
		fallthrough
	case "low":
		fallthrough
	case "medium":
		fallthrough
	case "high":
		*e = FindingsSeverityEnum(v)
		return nil
	default:
		return fmt.Errorf("invalid value for FindingsSeverityEnum: %v", v)
	}
}

type Findings struct {
	Confidence   *string               `json:"confidence,omitempty"`
	Description  *string               `json:"description,omitempty"`
	IssueID      *int64                `json:"issue_id,omitempty"`
	MetaLinks    []string              `json:"meta_links,omitempty"`
	MetaRisk     *FindingsMetaRisk     `json:"meta_risk,omitempty"`
	MetaTags     []string              `json:"meta_tags,omitempty"`
	MetaVulnRefs *FindingsMetaVulnRefs `json:"meta_vuln_refs,omitempty"`
	Raw          *string               `json:"raw,omitempty"`
	Severity     *FindingsSeverityEnum `json:"severity,omitempty"`
	Solution     *string               `json:"solution,omitempty"`
	TargetAddrs  []string              `json:"target_addrs,omitempty"`
	TargetProto  []string              `json:"target_proto,omitempty"`
	Timestamp    *time.Time            `json:"timestamp,omitempty"`
	Title        *string               `json:"title,omitempty"`
	Type         *string               `json:"type,omitempty"`
}
