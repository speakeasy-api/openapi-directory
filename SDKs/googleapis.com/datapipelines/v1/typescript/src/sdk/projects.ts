/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import * as utils from "../internal/utils";
import * as operations from "./models/operations";
import * as shared from "./models/shared";
import { AxiosInstance, AxiosRequestConfig, AxiosResponse } from "axios";

export class Projects {
  _defaultClient: AxiosInstance;
  _securityClient: AxiosInstance;
  _serverURL: string;
  _language: string;
  _sdkVersion: string;
  _genVersion: string;

  constructor(
    defaultClient: AxiosInstance,
    securityClient: AxiosInstance,
    serverURL: string,
    language: string,
    sdkVersion: string,
    genVersion: string
  ) {
    this._defaultClient = defaultClient;
    this._securityClient = securityClient;
    this._serverURL = serverURL;
    this._language = language;
    this._sdkVersion = sdkVersion;
    this._genVersion = genVersion;
  }

  /**
   * Creates a pipeline. For a batch pipeline, you can pass scheduler information. Data Pipelines uses the scheduler information to create an internal scheduler that runs jobs periodically. If the internal scheduler is not configured, you can use RunPipeline to run jobs.
   */
  datapipelinesProjectsLocationsPipelinesCreate(
    req: operations.DatapipelinesProjectsLocationsPipelinesCreateRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesCreateSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesCreateResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesCreateRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/v1/{parent}/pipelines",
      req
    );

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "googleCloudDatapipelinesV1PipelineInput",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesCreateSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "post",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesCreateResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesCreateResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1Pipeline = utils.objectToClass(
              httpRes?.data,
              shared.GoogleCloudDatapipelinesV1Pipeline
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Deletes a pipeline. If a scheduler job is attached to the pipeline, it will be deleted.
   */
  datapipelinesProjectsLocationsPipelinesDelete(
    req: operations.DatapipelinesProjectsLocationsPipelinesDeleteRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesDeleteSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesDeleteResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesDeleteRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{name}", req);
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesDeleteSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "delete",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesDeleteResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesDeleteResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleProtobufEmpty = utils.objectToClass(httpRes?.data);
          }
          break;
      }

      return res;
    });
  }

  /**
   * Looks up a single pipeline. Returns a "NOT_FOUND" error if no such pipeline exists. Returns a "FORBIDDEN" error if the caller doesn't have permission to access it.
   */
  datapipelinesProjectsLocationsPipelinesGet(
    req: operations.DatapipelinesProjectsLocationsPipelinesGetRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesGetSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesGetResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesGetRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{name}", req);
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesGetSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesGetResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesGetResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1Pipeline = utils.objectToClass(
              httpRes?.data,
              shared.GoogleCloudDatapipelinesV1Pipeline
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Lists jobs for a given pipeline. Throws a "FORBIDDEN" error if the caller doesn't have permission to access it.
   */
  datapipelinesProjectsLocationsPipelinesJobsList(
    req: operations.DatapipelinesProjectsLocationsPipelinesJobsListRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesJobsListSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesJobsListResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req =
        new operations.DatapipelinesProjectsLocationsPipelinesJobsListRequest(
          req
        );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{parent}/jobs", req);
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesJobsListSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesJobsListResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesJobsListResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1ListJobsResponse =
              utils.objectToClass(
                httpRes?.data,
                shared.GoogleCloudDatapipelinesV1ListJobsResponse
              );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Lists pipelines. Returns a "FORBIDDEN" error if the caller doesn't have permission to access it.
   */
  datapipelinesProjectsLocationsPipelinesList(
    req: operations.DatapipelinesProjectsLocationsPipelinesListRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesListSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesListResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesListRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/v1/{parent}/pipelines",
      req
    );
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesListSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesListResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesListResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1ListPipelinesResponse =
              utils.objectToClass(
                httpRes?.data,
                shared.GoogleCloudDatapipelinesV1ListPipelinesResponse
              );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Updates a pipeline. If successful, the updated Pipeline is returned. Returns `NOT_FOUND` if the pipeline doesn't exist. If UpdatePipeline does not return successfully, you can retry the UpdatePipeline request until you receive a successful response.
   */
  datapipelinesProjectsLocationsPipelinesPatch(
    req: operations.DatapipelinesProjectsLocationsPipelinesPatchRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesPatchSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesPatchResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesPatchRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{name}", req);

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "googleCloudDatapipelinesV1PipelineInput",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesPatchSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "patch",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesPatchResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesPatchResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1Pipeline = utils.objectToClass(
              httpRes?.data,
              shared.GoogleCloudDatapipelinesV1Pipeline
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Creates a job for the specified pipeline directly. You can use this method when the internal scheduler is not configured and you want to trigger the job directly or through an external system. Returns a "NOT_FOUND" error if the pipeline doesn't exist. Returns a "FORBIDDEN" error if the user doesn't have permission to access the pipeline or run jobs for the pipeline.
   */
  datapipelinesProjectsLocationsPipelinesRun(
    req: operations.DatapipelinesProjectsLocationsPipelinesRunRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesRunSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesRunResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesRunRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{name}:run", req);

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "requestBody",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesRunSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "post",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesRunResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesRunResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1RunPipelineResponse =
              utils.objectToClass(
                httpRes?.data,
                shared.GoogleCloudDatapipelinesV1RunPipelineResponse
              );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Freezes pipeline execution permanently. If there's a corresponding scheduler entry, it's deleted, and the pipeline state is changed to "ARCHIVED". However, pipeline metadata is retained.
   */
  datapipelinesProjectsLocationsPipelinesStop(
    req: operations.DatapipelinesProjectsLocationsPipelinesStopRequest,
    security: operations.DatapipelinesProjectsLocationsPipelinesStopSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.DatapipelinesProjectsLocationsPipelinesStopResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.DatapipelinesProjectsLocationsPipelinesStopRequest(
        req
      );
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(baseURL, "/v1/{name}:stop", req);

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "requestBody",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security =
        new operations.DatapipelinesProjectsLocationsPipelinesStopSecurity(
          security
        );
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };
    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "post",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.DatapipelinesProjectsLocationsPipelinesStopResponse =
        new operations.DatapipelinesProjectsLocationsPipelinesStopResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.googleCloudDatapipelinesV1Pipeline = utils.objectToClass(
              httpRes?.data,
              shared.GoogleCloudDatapipelinesV1Pipeline
            );
          }
          break;
      }

      return res;
    });
  }
}
