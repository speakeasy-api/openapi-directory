"""Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT."""

import requests as requests_http
from . import utils
from sdk.models import operations
from typing import Optional

class DirectDebits:
    r"""The fire.com api allows businesses to automate direct debit payment actions on their fire.com business accounts.
    
    You can retrieve details of your direct debit payments, direct debit mandates and also take actions on both your direct debit payments and mandates.
    """
    _client: requests_http.Session
    _security_client: requests_http.Session
    _server_url: str
    _language: str
    _sdk_version: str
    _gen_version: str

    def __init__(self, client: requests_http.Session, security_client: requests_http.Session, server_url: str, language: str, sdk_version: str, gen_version: str) -> None:
        self._client = client
        self._security_client = security_client
        self._server_url = server_url
        self._language = language
        self._sdk_version = sdk_version
        self._gen_version = gen_version
        
    def activate_mandate(self, request: operations.ActivateMandateRequest) -> operations.ActivateMandateResponse:
        r"""Activate a direct debit mandate
        This endpoint can only be used to activate a direct debit mandate when it is in the status REJECT_REQUESTED (even if the account has direct debits disabled). This action will also enable the account for direct debits if it was previously set to be disabled.
        The permision needed to access this endpoint is PERM_BUSINESS_POST_MANDATE_ACTIVATE
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.ActivateMandateRequest, base_url, '/v1/mandates/{mandateUuid}/activate', request)
        
        
        client = self._security_client
        
        http_res = client.request('POST', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.ActivateMandateResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        

        return res

    def cancel_mandate_by_uuid(self, request: operations.CancelMandateByUUIDRequest) -> operations.CancelMandateByUUIDResponse:
        r"""Cancel a direct debit mandate
        This endpoint allows you to cancel a direct debit mandate.
        The permision needed to access this endpoint is PERM_BUSINESS_POST_MANDATE_CANCEL
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.CancelMandateByUUIDRequest, base_url, '/v1/mandates/{mandateUuid}/cancel', request)
        
        
        client = self._security_client
        
        http_res = client.request('POST', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.CancelMandateByUUIDResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        

        return res

    def get_direct_debit_by_uuid(self, request: operations.GetDirectDebitByUUIDRequest) -> operations.GetDirectDebitByUUIDResponse:
        r"""Get the details of a direct debit
        Retrieve all details of a single direct debit collection/payment, whether successful or not.
        The permision needed to access this endpoint is **PERM_BUSINESS_GET_DIRECT_DEBIT**
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.GetDirectDebitByUUIDRequest, base_url, '/v1/directdebits/{directDebitUuid}', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetDirectDebitByUUIDResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[operations.GetDirectDebitByUUIDDirectDebit])
                res.direct_debit = out

        return res

    def get_direct_debit_mandates(self) -> operations.GetDirectDebitMandatesResponse:
        r"""List all direct debit mandates
        The permision needed to access this endpoint is PERM_BUSINESS_GET_MANDATES
        """
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/mandates'
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetDirectDebitMandatesResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[operations.GetDirectDebitMandatesMandates])
                res.mandates = out

        return res

    def get_direct_debits_for_mandate_uuid(self, request: operations.GetDirectDebitsForMandateUUIDRequest) -> operations.GetDirectDebitsForMandateUUIDResponse:
        r"""Get all DD payments associated with a direct debit mandate
        Retrieve all direct debit payments associated with a direct debit mandate.
        The permision needed to access this endpoint is PERM_BUSINESS_GET_DIRECT_DEBITS
        """
        base_url = self._server_url
        
        url = base_url.removesuffix('/') + '/v1/directdebits'
        
        query_params = utils.get_query_params(operations.GetDirectDebitsForMandateUUIDRequest, request)
        
        client = self._security_client
        
        http_res = client.request('GET', url, params=query_params)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetDirectDebitsForMandateUUIDResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[operations.GetDirectDebitsForMandateUUIDDirectDebits])
                res.direct_debits = out

        return res

    def get_mandate(self, request: operations.GetMandateRequest) -> operations.GetMandateResponse:
        r"""Get direct debit mandate details
        Retrieve all details for a direct debit mandate.
        The permision needed to access this endpoint is PERM_BUSINESS_GET_MANDATE
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.GetMandateRequest, base_url, '/v1/mandates/{mandateUuid}', request)
        
        
        client = self._security_client
        
        http_res = client.request('GET', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.GetMandateResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        
        if http_res.status_code == 200:
            if utils.match_content_type(content_type, 'application/json'):
                out = utils.unmarshal_json(http_res.text, Optional[operations.GetMandateMandate])
                res.mandate = out

        return res

    def reject_direct_debit(self, request: operations.RejectDirectDebitRequest) -> operations.RejectDirectDebitResponse:
        r"""Reject a direct debit payment
        This endpoint allows you to reject a direct debit payment where the status is still set to RECEIVED.
        Permission name PERM_BUSINESS_POST_DIRECT_DEBIT_REJECT
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.RejectDirectDebitRequest, base_url, '/v1/directdebits/{directDebitUuid}/reject', request)
        
        
        client = self._security_client
        
        http_res = client.request('POST', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.RejectDirectDebitResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        

        return res

    def update_mandate_alias(self, request: operations.UpdateMandateAliasRequest) -> operations.UpdateMandateAliasResponse:
        r"""Update a direct debit mandate alias
        Update Direct Debit Mandate Alias
        The permision needed to access this endpoint is PERM_BUSINESS_PUT_MANDATE
        """
        base_url = self._server_url
        
        url = utils.generate_url(operations.UpdateMandateAliasRequest, base_url, '/v1/mandates/{mandateUuid}', request)
        
        
        client = self._security_client
        
        http_res = client.request('POST', url)
        content_type = http_res.headers.get('Content-Type')

        res = operations.UpdateMandateAliasResponse(status_code=http_res.status_code, content_type=content_type, raw_response=http_res)
        

        return res

    