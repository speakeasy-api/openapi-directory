/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { DependabotAlertSecurityVulnerability } from "./dependabotalertsecurityvulnerability";
import { Expose, Transform, Type } from "class-transformer";

/**
 * Details for the advisory pertaining to the Common Vulnerability Scoring System.
 */
export class DependabotAlertSecurityAdvisoryCvss extends SpeakeasyBase {
  /**
   * The overall CVSS score of the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "score" })
  score: number;

  /**
   * The full CVSS vector string for the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "vector_string" })
  vectorString: string;
}

/**
 * A CWE weakness assigned to the advisory.
 */
export class DependabotAlertSecurityAdvisoryCwes extends SpeakeasyBase {
  /**
   * The unique CWE ID.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "cwe_id" })
  cweId: string;

  /**
   * The short, plain text name of the CWE.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "name" })
  name: string;
}

/**
 * The type of advisory identifier.
 */
export enum DependabotAlertSecurityAdvisoryIdentifiersTypeEnum {
  Cve = "CVE",
  Ghsa = "GHSA",
}

/**
 * An advisory identifier.
 */
export class DependabotAlertSecurityAdvisoryIdentifiers extends SpeakeasyBase {
  /**
   * The type of advisory identifier.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "type" })
  type: DependabotAlertSecurityAdvisoryIdentifiersTypeEnum;

  /**
   * The value of the advisory identifer.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "value" })
  value: string;
}

/**
 * A link to additional advisory information.
 */
export class DependabotAlertSecurityAdvisoryReferences extends SpeakeasyBase {
  /**
   * The URL of the reference.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "url" })
  url: string;
}

/**
 * The severity of the advisory.
 */
export enum DependabotAlertSecurityAdvisorySeverityEnum {
  Low = "low",
  Medium = "medium",
  High = "high",
  Critical = "critical",
}

/**
 * Details for the GitHub Security Advisory.
 */
export class DependabotAlertSecurityAdvisory extends SpeakeasyBase {
  /**
   * The unique CVE ID assigned to the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "cve_id" })
  cveId: string;

  /**
   * Details for the advisory pertaining to the Common Vulnerability Scoring System.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "cvss" })
  @Type(() => DependabotAlertSecurityAdvisoryCvss)
  cvss: DependabotAlertSecurityAdvisoryCvss;

  /**
   * Details for the advisory pertaining to Common Weakness Enumeration.
   */
  @SpeakeasyMetadata({ elemType: DependabotAlertSecurityAdvisoryCwes })
  @Expose({ name: "cwes" })
  @Type(() => DependabotAlertSecurityAdvisoryCwes)
  cwes: DependabotAlertSecurityAdvisoryCwes[];

  /**
   * A long-form Markdown-supported description of the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "description" })
  description: string;

  /**
   * The unique GitHub Security Advisory ID assigned to the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "ghsa_id" })
  ghsaId: string;

  /**
   * Values that identify this advisory among security information sources.
   */
  @SpeakeasyMetadata({ elemType: DependabotAlertSecurityAdvisoryIdentifiers })
  @Expose({ name: "identifiers" })
  @Type(() => DependabotAlertSecurityAdvisoryIdentifiers)
  identifiers: DependabotAlertSecurityAdvisoryIdentifiers[];

  /**
   * The time that the advisory was published in ISO 8601 format: `YYYY-MM-DDTHH:MM:SSZ`.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "published_at" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  publishedAt: Date;

  /**
   * Links to additional advisory information.
   */
  @SpeakeasyMetadata({ elemType: DependabotAlertSecurityAdvisoryReferences })
  @Expose({ name: "references" })
  @Type(() => DependabotAlertSecurityAdvisoryReferences)
  references: DependabotAlertSecurityAdvisoryReferences[];

  /**
   * The severity of the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "severity" })
  severity: DependabotAlertSecurityAdvisorySeverityEnum;

  /**
   * A short, plain text summary of the advisory.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "summary" })
  summary: string;

  /**
   * The time that the advisory was last modified in ISO 8601 format: `YYYY-MM-DDTHH:MM:SSZ`.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "updated_at" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  updatedAt: Date;

  /**
   * Vulnerable version range information for the advisory.
   */
  @SpeakeasyMetadata({ elemType: DependabotAlertSecurityVulnerability })
  @Expose({ name: "vulnerabilities" })
  @Type(() => DependabotAlertSecurityVulnerability)
  vulnerabilities: DependabotAlertSecurityVulnerability[];

  /**
   * The time that the advisory was withdrawn in ISO 8601 format: `YYYY-MM-DDTHH:MM:SSZ`.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "withdrawn_at" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  withdrawnAt: Date;
}
