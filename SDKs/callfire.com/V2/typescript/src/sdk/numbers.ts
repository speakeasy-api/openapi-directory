/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import * as utils from "../internal/utils";
import * as operations from "./models/operations";
import * as shared from "./models/shared";
import { AxiosInstance, AxiosRequestConfig, AxiosResponse } from "axios";

export class Numbers {
  _defaultClient: AxiosInstance;
  _securityClient: AxiosInstance;
  _serverURL: string;
  _language: string;
  _sdkVersion: string;
  _genVersion: string;

  constructor(
    defaultClient: AxiosInstance,
    securityClient: AxiosInstance,
    serverURL: string,
    language: string,
    sdkVersion: string,
    genVersion: string
  ) {
    this._defaultClient = defaultClient;
    this._securityClient = securityClient;
    this._serverURL = serverURL;
    this._language = language;
    this._sdkVersion = sdkVersion;
    this._genVersion = genVersion;
  }

  /**
   * Find lease configs
   *
   * @remarks
   * Searches for all number lease configs for the user. Returns a paged list of NumberConfig
   */
  findNumberLeaseConfigs(
    req: operations.FindNumberLeaseConfigsRequest,
    security: operations.FindNumberLeaseConfigsSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.FindNumberLeaseConfigsResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.FindNumberLeaseConfigsRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = baseURL.replace(/\/$/, "") + "/numbers/leases/configs";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.FindNumberLeaseConfigsSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.FindNumberLeaseConfigsResponse =
        new operations.FindNumberLeaseConfigsResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberConfigPage = utils.objectToClass(
              httpRes?.data,
              shared.NumberConfigPage
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find leases
   *
   * @remarks
   * Searches for all numbers leased by account user. This API is useful for finding all numbers currently owned by the user. Returns a paged list of number leases.
   */
  findNumberLeases(
    req: operations.FindNumberLeasesRequest,
    security: operations.FindNumberLeasesSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.FindNumberLeasesResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.FindNumberLeasesRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = baseURL.replace(/\/$/, "") + "/numbers/leases";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.FindNumberLeasesSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.FindNumberLeasesResponse =
        new operations.FindNumberLeasesResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberLeasePage = utils.objectToClass(
              httpRes?.data,
              shared.NumberLeasePage
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find number regions
   *
   * @remarks
   * Searches for region information. Use this API to obtain detailed region information that can be used to query for more specific phone numbers than a general query.
   */
  findNumberRegions(
    req: operations.FindNumberRegionsRequest,
    security: operations.FindNumberRegionsSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.FindNumberRegionsResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.FindNumberRegionsRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = baseURL.replace(/\/$/, "") + "/numbers/regions";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.FindNumberRegionsSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.FindNumberRegionsResponse =
        new operations.FindNumberRegionsResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.regionPage = utils.objectToClass(
              httpRes?.data,
              shared.RegionPage
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find local numbers
   *
   * @remarks
   * Searches for numbers available for purchase in CallFire local numbers catalog . At least one additional parameter is required. User may filter local numbers by their region information. If all numbers with desirable zip code is already busy search will return available numbers with nearest zip code.
   */
  findNumbersLocal(
    req: operations.FindNumbersLocalRequest,
    security: operations.FindNumbersLocalSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.FindNumbersLocalResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.FindNumbersLocalRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = baseURL.replace(/\/$/, "") + "/numbers/local";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.FindNumbersLocalSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.FindNumbersLocalResponse =
        new operations.FindNumbersLocalResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberList = utils.objectToClass(
              httpRes?.data,
              shared.NumberList
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find tollfree numbers
   *
   * @remarks
   * Searches for the toll free numbers which are available for purchase in the CallFire catalog
   */
  findNumbersTollfree(
    req: operations.FindNumbersTollfreeRequest,
    security: operations.FindNumbersTollfreeSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.FindNumbersTollfreeResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.FindNumbersTollfreeRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = baseURL.replace(/\/$/, "") + "/numbers/tollfree";
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.FindNumbersTollfreeSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.FindNumbersTollfreeResponse =
        new operations.FindNumbersTollfreeResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberList = utils.objectToClass(
              httpRes?.data,
              shared.NumberList
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find a specific lease
   *
   * @remarks
   * Returns a single NumberLease instance for a given number
   */
  getNumberLease(
    req: operations.GetNumberLeaseRequest,
    security: operations.GetNumberLeaseSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.GetNumberLeaseResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.GetNumberLeaseRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/numbers/leases/{number}",
      req
    );
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.GetNumberLeaseSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.GetNumberLeaseResponse =
        new operations.GetNumberLeaseResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberLease = utils.objectToClass(
              httpRes?.data,
              shared.NumberLease
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Find a specific lease config
   *
   * @remarks
   * Returns a single NumberConfig instance for a given number lease
   */
  getNumberLeaseConfig(
    req: operations.GetNumberLeaseConfigRequest,
    security: operations.GetNumberLeaseConfigSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.GetNumberLeaseConfigResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.GetNumberLeaseConfigRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/numbers/leases/configs/{number}",
      req
    );
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.GetNumberLeaseConfigSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const queryParams: string = utils.serializeQueryParams(req);

    const r = client.request({
      url: url + queryParams,
      method: "get",
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.GetNumberLeaseConfigResponse =
        new operations.GetNumberLeaseConfigResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case httpRes?.status == 200:
          if (utils.matchContentType(contentType, `application/json`)) {
            res.numberConfig = utils.objectToClass(
              httpRes?.data,
              shared.NumberConfig
            );
          }
          break;
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Update a lease
   *
   * @remarks
   * Updates a number lease instance. Ability to turn on/off autoRenew and toggle call/text features for a particular number
   */
  updateNumberLease(
    req: operations.UpdateNumberLeaseRequest,
    security: operations.UpdateNumberLeaseSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.UpdateNumberLeaseResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.UpdateNumberLeaseRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/numbers/leases/{number}",
      req
    );

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "numberLeaseInput",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.UpdateNumberLeaseSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };

    const r = client.request({
      url: url,
      method: "put",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.UpdateNumberLeaseResponse =
        new operations.UpdateNumberLeaseResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }

  /**
   * Update a lease config
   *
   * @remarks
   * Updates a phone number lease configuration. Use this API endpoint to add an Inbound IVR or Call Tracking feature to a CallFire phone number. Call tracking configuration allows you to track the incoming calls, to analyze and to respond customers using sms or voice replies. For more information see [call tracking page](https://www.callfire.com/products/call-tracking)
   */
  updateNumberLeaseConfig(
    req: operations.UpdateNumberLeaseConfigRequest,
    security: operations.UpdateNumberLeaseConfigSecurity,
    config?: AxiosRequestConfig
  ): Promise<operations.UpdateNumberLeaseConfigResponse> {
    if (!(req instanceof utils.SpeakeasyBase)) {
      req = new operations.UpdateNumberLeaseConfigRequest(req);
    }

    const baseURL: string = this._serverURL;
    const url: string = utils.generateURL(
      baseURL,
      "/numbers/leases/configs/{number}",
      req
    );

    let [reqBodyHeaders, reqBody]: [object, any] = [{}, {}];

    try {
      [reqBodyHeaders, reqBody] = utils.serializeRequestBody(
        req,
        "numberConfig",
        "json"
      );
    } catch (e: unknown) {
      if (e instanceof Error) {
        throw new Error(`Error serializing request body, cause: ${e.message}`);
      }
    }
    if (!(security instanceof utils.SpeakeasyBase)) {
      security = new operations.UpdateNumberLeaseConfigSecurity(security);
    }
    const client: AxiosInstance = utils.createSecurityClient(
      this._defaultClient,
      security
    );

    const headers = { ...reqBodyHeaders, ...config?.headers };

    const r = client.request({
      url: url,
      method: "put",
      headers: headers,
      data: reqBody,
      ...config,
    });

    return r.then((httpRes: AxiosResponse) => {
      const contentType: string = httpRes?.headers?.["content-type"] ?? "";

      if (httpRes?.status == null)
        throw new Error(`status code not found in response: ${httpRes}`);
      const res: operations.UpdateNumberLeaseConfigResponse =
        new operations.UpdateNumberLeaseConfigResponse({
          statusCode: httpRes.status,
          contentType: contentType,
          rawResponse: httpRes,
        });
      switch (true) {
        case [400, 401, 403, 404, 500].includes(httpRes?.status):
          if (utils.matchContentType(contentType, `application/json`)) {
            res.errorResponse = utils.objectToClass(
              httpRes?.data,
              shared.ErrorResponse
            );
          }
          break;
      }

      return res;
    });
  }
}
