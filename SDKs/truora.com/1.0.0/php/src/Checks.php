<?php

/**
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

declare(strict_types=1);

namespace OpenAPI\OpenAPI;

class Checks 
{

	// SDK private variables namespaced with _ to avoid conflicts with API models
	private \GuzzleHttp\ClientInterface $_defaultClient;
	private \GuzzleHttp\ClientInterface $_securityClient;
	private string $_serverUrl;
	private string $_language;
	private string $_sdkVersion;
	private string $_genVersion;	

	/**
	 * @param \GuzzleHttp\ClientInterface $defaultClient
	 * @param \GuzzleHttp\ClientInterface $securityClient
	 * @param string $serverUrl
	 * @param string $language
	 * @param string $sdkVersion
	 * @param string $genVersion
	 */
	public function __construct(\GuzzleHttp\ClientInterface $defaultClient, \GuzzleHttp\ClientInterface $securityClient, string $serverUrl, string $language, string $sdkVersion, string $genVersion)
	{
		$this->_defaultClient = $defaultClient;
		$this->_securityClient = $securityClient;
		$this->_serverUrl = $serverUrl;
		$this->_language = $language;
		$this->_sdkVersion = $sdkVersion;
		$this->_genVersion = $genVersion;
	}
	
    /**
     * Get Health Dashboard
     * 
     * Get the status of a database
     * 
     * @param \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardRequest $request
     * @param \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardSecurity $security
     * @return \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardResponse
     */
	public function getHealthDashboard(
        \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardRequest $request,
        \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardSecurity $security,
    ): \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardResponse
    {
        $baseUrl = $this->_serverUrl;
        $url = Utils\Utils::generateUrl($baseUrl, '/v1/checks/health');
        
        $options = ['http_errors' => false];
        $options = array_merge_recursive($options, Utils\Utils::getQueryParams(\OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardRequest::class, $request, null));
        
        $client = Utils\Utils::configureSecurityClient($this->_defaultClient, $security);
        $httpResponse = $client->request('GET', $url, $options);
        
        $contentType = $httpResponse->getHeader('Content-Type')[0] ?? '';

        $response = new \OpenAPI\OpenAPI\Models\Operations\GetHealthDashboardResponse();
        $response->statusCode = $httpResponse->getStatusCode();
        $response->contentType = $contentType;
        $response->rawResponse = $httpResponse;
        
        if ($httpResponse->getStatusCode() === 200) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->databases = $serializer->deserialize((string)$httpResponse->getBody(), 'array<OpenAPI\OpenAPI\Models\Shared\Database>', 'json');
            }
        }

        return $response;
    }
	
    /**
     * Create a background check
     * 
     * Creates a background check and queues it to start collecting information. The full details of background checks can be retrieved with their respective Check IDs using getCheck endpoint. Keep in mind that, depending on the check type, input document, and country of a search, certain inputs are required. You should always provide as many inputs as possible in order to get the highest accuracy.
     * 
     * If your check type is not referenced in the following table, please reach out to find out the fields that apply for you.
     * 
     * | Country | Person-National | PersonForeigner | Company | Vehicle-National | Vehicle-Foreigner |
     * |:-------:|:---------------:|:---------------:|:-------:|:----------------:|:-----------------:|
     * | Chile<br>CL | national_id*<br>date_of_birth<br>phone_number | foreign_id*<br>date_of_birth*<br>phone_number<br>first_name*<br>last_name*<br>native_country* | N/A | national_id*<br>license_plate*<br>payment_date (Santiago only)<br>driver_license (Santiago only) | foreign_id*<br>first_name*<br>last_name*<br>date_of_birth*<br>native_country*<br>license_plate*<br>payment_date (Santiago only)<br>driver_license (Santiago only) |
     * | Colombia<br>CO | national_id*<br>date_of_birth<br>issue_date<br>phone_number | foreign_id* or PEP*<br>date_of_birth<br>phone_number<br>issue_date* | tax_id*<br>national_id | national_id*<br>date_of_birth<br>phone_number<br>license_plate*<br>owner_document_type<br>owner_document_id | foreign_id*<br>date_of_birth<br>phone_number<br>license_plate*<br>issue_date* |
     * | Mexico<br>MX | national_id*<br>phone_number | foreign_id* | tax_id* | license_plate*<br>national_id<br>vehicle_id<br>driver_license(Estado de Mexico only) | N/A |
     * | Brazil<br>BR | national_id*<br>date_of_birth*<br>region*<br>phone_number | N/A | tax_id* | license_plate* | N/A |
     * | Costa Rica<br>CR | national_id*<br>phone_number | foreign_id* | N/A | license_plate* | N/A |
     * | Ecuador<br>EC | national_id*<br>phone_number | foreign_id* | tax_id* | license_plate* | N/A |
     * | Peru<br>PE | national_id*<br>date_of_birth<br>phone_number | foreign_id*<br>ptp<br>date_of_birth*<br>phone_number | N/A | national_id*<br>date_of_birth<br>license_plate* | foreign_id*<br>ptp<br>date_of_birth*<br>license_plate* |
     * | Argentina<br>AR | national_id* | N/A | N/A | national_id* | N/A |
     * | International<br>ALL | name* | name* | company_name* | N/A | N/A |
     * 
     * (*) Required field
     * 
     * @param \OpenAPI\OpenAPI\Models\Operations\CreateCheckRequest $request
     * @param \OpenAPI\OpenAPI\Models\Operations\CreateCheckSecurity $security
     * @return \OpenAPI\OpenAPI\Models\Operations\CreateCheckResponse
     */
	public function createCheck(
        \OpenAPI\OpenAPI\Models\Operations\CreateCheckRequest $request,
        \OpenAPI\OpenAPI\Models\Operations\CreateCheckSecurity $security,
    ): \OpenAPI\OpenAPI\Models\Operations\CreateCheckResponse
    {
        $baseUrl = $this->_serverUrl;
        $url = Utils\Utils::generateUrl($baseUrl, '/v1/checks');
        
        $options = ['http_errors' => false];
        $body = Utils\Utils::serializeRequestBody($request, "createCheckInput", "form");
        if ($body === null) {
            throw new \Exception('Request body is required');
        }
        $options = array_merge_recursive($options, $body);
        $options = array_merge_recursive($options, Utils\Utils::getHeaders($request));
        
        $client = Utils\Utils::configureSecurityClient($this->_defaultClient, $security);
        $httpResponse = $client->request('POST', $url, $options);
        
        $contentType = $httpResponse->getHeader('Content-Type')[0] ?? '';

        $response = new \OpenAPI\OpenAPI\Models\Operations\CreateCheckResponse();
        $response->statusCode = $httpResponse->getStatusCode();
        $response->contentType = $contentType;
        $response->rawResponse = $httpResponse;
        
        if ($httpResponse->getStatusCode() === 201) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->checkOutput = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\CheckOutput', 'json');
            }
        }
        else if ($httpResponse->getStatusCode() === 400 or $httpResponse->getStatusCode() === 429) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->error = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\Error', 'json');
            }
        }

        return $response;
    }
	
    /**
     * Get Background Check
     * 
     * Returns the results of the check that matches the ID provided, complete with a set of scores explained below.
     * 
     * ### Scores:
     * 
     * 
     * - **Global Score**: Average risk associated with a person, company or vehicle, according to  the background check results. The global score considers results that are validated with the  ID number provided. The score ranges from 0 to 1, where 0 represents high risk and 1 low risk.
     * 
     * 
     * - **ID Score**: Average risk associated with a person according to the background check  results. The ID score considers the results that are validated with a person identity  document. The score ranges from 0 to 1, where 0 represents high risk and 1 low risk. 
     * 
     * 
     * - **Homonym Score**: Average risk associated with a person according to the background check  results. The homonym score considers results that are validated against the name of a person and could not be validated with their ID number. These results might have homonyms associated with them. The score ranges from 0 to 1, where 0 represents high risk and 1 low risk.
     * 
     * 
     * In order to calculate these scores, a weighted average is considered with different weights allocated to each dataset. Scores can be customized using the config endpoints by assigning a weight to each dataset according to its relevance.
     * 
     * Keep in mind that results from the API vary depending on the country, check type and the inputs entered on check creation.
     * 
     * @param \OpenAPI\OpenAPI\Models\Operations\GetCheckRequest $request
     * @param \OpenAPI\OpenAPI\Models\Operations\GetCheckSecurity $security
     * @return \OpenAPI\OpenAPI\Models\Operations\GetCheckResponse
     */
	public function getCheck(
        \OpenAPI\OpenAPI\Models\Operations\GetCheckRequest $request,
        \OpenAPI\OpenAPI\Models\Operations\GetCheckSecurity $security,
    ): \OpenAPI\OpenAPI\Models\Operations\GetCheckResponse
    {
        $baseUrl = $this->_serverUrl;
        $url = Utils\Utils::generateUrl($baseUrl, '/v1/checks/{check_id}', \OpenAPI\OpenAPI\Models\Operations\GetCheckRequest::class, $request);
        
        $options = ['http_errors' => false];
        
        $client = Utils\Utils::configureSecurityClient($this->_defaultClient, $security);
        $httpResponse = $client->request('GET', $url, $options);
        
        $contentType = $httpResponse->getHeader('Content-Type')[0] ?? '';

        $response = new \OpenAPI\OpenAPI\Models\Operations\GetCheckResponse();
        $response->statusCode = $httpResponse->getStatusCode();
        $response->contentType = $contentType;
        $response->rawResponse = $httpResponse;
        
        if ($httpResponse->getStatusCode() === 200) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->checkOutput = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\CheckOutput', 'json');
            }
        }
        else if ($httpResponse->getStatusCode() === 404) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->error = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\Error', 'json');
            }
        }

        return $response;
    }
	
    /**
     * List Check Details
     * 
     * Lists all details associated with a Check. It can be paginated.
     * 
     * @param \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsRequest $request
     * @param \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsSecurity $security
     * @return \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsResponse
     */
	public function listCheckDetails(
        \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsRequest $request,
        \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsSecurity $security,
    ): \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsResponse
    {
        $baseUrl = $this->_serverUrl;
        $url = Utils\Utils::generateUrl($baseUrl, '/v1/checks/{check_id}/details', \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsRequest::class, $request);
        
        $options = ['http_errors' => false];
        $options = array_merge_recursive($options, Utils\Utils::getQueryParams(\OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsRequest::class, $request, null));
        
        $client = Utils\Utils::configureSecurityClient($this->_defaultClient, $security);
        $httpResponse = $client->request('GET', $url, $options);
        
        $contentType = $httpResponse->getHeader('Content-Type')[0] ?? '';

        $response = new \OpenAPI\OpenAPI\Models\Operations\ListCheckDetailsResponse();
        $response->statusCode = $httpResponse->getStatusCode();
        $response->contentType = $contentType;
        $response->rawResponse = $httpResponse;
        
        if ($httpResponse->getStatusCode() === 200) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->checkDetailsOutput = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\CheckDetailsOutput', 'json');
            }
        }

        return $response;
    }
	
    /**
     * List Checks
     * 
     * Lists the existing checks in the account or in a specified report.
     * 
     * @param \OpenAPI\OpenAPI\Models\Operations\ListChecksRequest $request
     * @param \OpenAPI\OpenAPI\Models\Operations\ListChecksSecurity $security
     * @return \OpenAPI\OpenAPI\Models\Operations\ListChecksResponse
     */
	public function listChecks(
        \OpenAPI\OpenAPI\Models\Operations\ListChecksRequest $request,
        \OpenAPI\OpenAPI\Models\Operations\ListChecksSecurity $security,
    ): \OpenAPI\OpenAPI\Models\Operations\ListChecksResponse
    {
        $baseUrl = $this->_serverUrl;
        $url = Utils\Utils::generateUrl($baseUrl, '/v1/checks');
        
        $options = ['http_errors' => false];
        $options = array_merge_recursive($options, Utils\Utils::getQueryParams(\OpenAPI\OpenAPI\Models\Operations\ListChecksRequest::class, $request, null));
        
        $client = Utils\Utils::configureSecurityClient($this->_defaultClient, $security);
        $httpResponse = $client->request('GET', $url, $options);
        
        $contentType = $httpResponse->getHeader('Content-Type')[0] ?? '';

        $response = new \OpenAPI\OpenAPI\Models\Operations\ListChecksResponse();
        $response->statusCode = $httpResponse->getStatusCode();
        $response->contentType = $contentType;
        $response->rawResponse = $httpResponse;
        
        if ($httpResponse->getStatusCode() === 200) {
            if (Utils\Utils::matchContentType($contentType, 'application/json')) {
                $serializer = Utils\JSON::createSerializer();
                $response->checksOutput = $serializer->deserialize((string)$httpResponse->getBody(), 'OpenAPI\OpenAPI\Models\Shared\ChecksOutput', 'json');
            }
        }

        return $response;
    }
}