/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { CertificateReference } from "./certificatereference";
import { ComputeNodeError } from "./computenodeerror";
import { StartTask } from "./starttask";
import { StartTaskInformation } from "./starttaskinformation";
import { TaskInformation } from "./taskinformation";
import { Expose, Transform, Type } from "class-transformer";

/**
 * Whether the compute node should be available for task scheduling.
 */
export enum ComputeNodeSchedulingStateEnum {
  Enabled = "enabled",
  Disabled = "disabled",
}

/**
 * The current state of the compute node.
 */
export enum ComputeNodeStateEnum {
  Idle = "idle",
  Rebooting = "rebooting",
  Reimaging = "reimaging",
  Running = "running",
  Unusable = "unusable",
  Creating = "creating",
  Starting = "starting",
  Waitingforstarttask = "waitingforstarttask",
  Starttaskfailed = "starttaskfailed",
  Unknown = "unknown",
  Leavingpool = "leavingpool",
  Offline = "offline",
}

/**
 * A compute node in the Batch service.
 */
export class ComputeNode extends SpeakeasyBase {
  /**
   * An identifier which can be passed in the Add Task API to request that the task be scheduled close to this compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "affinityId" })
  affinityId?: string;

  /**
   * The time at which this compute node was allocated to the pool.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "allocationTime" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  allocationTime?: Date;

  /**
   * The list of certificates installed on the compute node.
   */
  @SpeakeasyMetadata({ elemType: CertificateReference })
  @Expose({ name: "certificateReferences" })
  @Type(() => CertificateReference)
  certificateReferences?: CertificateReference[];

  /**
   * The list of errors that are currently being encountered by the compute node.
   */
  @SpeakeasyMetadata({ elemType: ComputeNodeError })
  @Expose({ name: "errors" })
  @Type(() => ComputeNodeError)
  errors?: ComputeNodeError[];

  /**
   * The id of the compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "id" })
  id?: string;

  /**
   * The IP address that other compute nodes can use to communicate with this compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "ipAddress" })
  ipAddress?: string;

  /**
   * The time at which the compute node was started.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "lastBootTime" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  lastBootTime?: Date;

  /**
   * The list of tasks that are currently running on the compute node.
   */
  @SpeakeasyMetadata({ elemType: TaskInformation })
  @Expose({ name: "recentTasks" })
  @Type(() => TaskInformation)
  recentTasks?: TaskInformation[];

  /**
   * The total number of currently running job tasks on the compute node. This includes Job Preparation, Job Release, and Job Manager tasks, but not the pool start task.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "runningTasksCount" })
  runningTasksCount?: number;

  /**
   * Whether the compute node should be available for task scheduling.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "schedulingState" })
  schedulingState?: ComputeNodeSchedulingStateEnum;

  /**
   * A task which is run when a compute node joins a pool in the Azure Batch service, or when the compute node is rebooted or reimaged.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "startTask" })
  @Type(() => StartTask)
  startTask?: StartTask;

  /**
   * Information about a start task running on a compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "startTaskInfo" })
  @Type(() => StartTaskInformation)
  startTaskInfo?: StartTaskInformation;

  /**
   * The current state of the compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "state" })
  state?: ComputeNodeStateEnum;

  /**
   * The time at which the compute node entered its current state.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "stateTransitionTime" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  stateTransitionTime?: Date;

  /**
   * The total number of job tasks completed on the compute node. This includes Job Preparation, Job Release and Job Manager tasks, but not the pool start task.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "totalTasksRun" })
  totalTasksRun?: number;

  /**
   * The total number of job tasks which completed successfully (with exitCode 0) on the compute node. This includes Job Preparation, Job Release, and Job Manager tasks, but not the pool start task.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "totalTasksSucceeded" })
  totalTasksSucceeded?: number;

  /**
   * The URL of the compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "url" })
  url?: string;

  /**
   * The size of the virtual machine hosting the compute node.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "vmSize" })
  vmSize?: string;
}
