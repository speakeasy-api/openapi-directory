/*
 * Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.
 */

import { SpeakeasyBase, SpeakeasyMetadata } from "../../../internal/utils";
import { Asset } from "./asset";
import { ChangedBy } from "./changedby";
import { EnvironmentEnum } from "./environmentenum";
import { ReportTypeEnum } from "./reporttypeenum";
import { ScanProfileEnum } from "./scanprofileenum";
import { Site, SiteInput } from "./site";
import { TargetTypeEnum } from "./targettypeenum";
import { Expose, Transform, Type } from "class-transformer";

export class TargetInput extends SpeakeasyBase {
  /**
   * Id of the connected target in a multi-environment targets.
   *
   * @remarks
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "connected_target" })
  connectedTarget?: string;

  /**
   * Multi-environment targets can identify environments using this property.
   *
   * @remarks
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "environment" })
  environment?: EnvironmentEnum;

  /**
   * User labels for the scope. (This feature is currently only available for certain accounts,
   *
   * @remarks
   * please contact our support if you are interested in using it)
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "labels" })
  labels?: string[];

  /**
   * Custom name for the resource
   */
  @SpeakeasyMetadata()
  @Expose({ name: "name" })
  name?: string;

  /**
   * * default - default report, no extra information added
   *
   * @remarks
   * * owasp - adds table on OWASP Top 10 most critical web application risks
   * * pci - adds table on PCI requirements
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "report_type" })
  reportType?: ReportTypeEnum;

  /**
   * * lightning - fast simple scan
   *
   * @remarks
   * * normal - default profile
   * * full - does everything the default profile does and adds boolean based
   * SQL injection tests
   * * safe - doesn't use any content changing methods (no POST, DELETE, etc)
   * and tries fewer payloads for SQL injection tests
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "scan_profile" })
  scanProfile?: ScanProfileEnum;

  /**
   * Main resource associated with a target
   */
  @SpeakeasyMetadata()
  @Expose({ name: "site" })
  @Type(() => SiteInput)
  site?: SiteInput;

  /**
   * The type of a target determines what the limitations imposed on a
   *
   * @remarks
   * target.
   * * free - Every account is allowed to have 5 free targets, these targets
   * do not need to be verified but can only perform lightning
   * scans.
   * * single - Single environment targets need to be verified but are
   * allowed to run any type of scan allowed by the plan.
   * * multi - Multi environment targets are used when you want
   * to scan the same application in different environments.
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "type" })
  type?: TargetTypeEnum;
}

export class TargetAllowedScanProfiles extends SpeakeasyBase {
  /**
   * * lightning - fast simple scan
   *
   * @remarks
   * * normal - default profile
   * * full - does everything the default profile does and adds boolean based
   * SQL injection tests
   * * safe - doesn't use any content changing methods (no POST, DELETE, etc)
   * and tries fewer payloads for SQL injection tests
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "id" })
  id?: ScanProfileEnum;

  /**
   * Name of the scan profile.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "name" })
  name?: string;
}

/**
 * Event object.
 */
export class Target extends SpeakeasyBase {
  /**
   * Valid scan profiles for the target.
   */
  @SpeakeasyMetadata({ elemType: TargetAllowedScanProfiles })
  @Expose({ name: "allowed_scan_profiles" })
  @Type(() => TargetAllowedScanProfiles)
  allowedScanProfiles?: TargetAllowedScanProfiles[];

  /**
   * Secondary domains that should be scanned
   */
  @SpeakeasyMetadata({ elemType: Asset })
  @Expose({ name: "assets" })
  @Type(() => Asset)
  assets?: Asset[];

  /**
   * Date time of the last change
   */
  @SpeakeasyMetadata()
  @Expose({ name: "changed" })
  @Transform(({ value }) => new Date(value), { toClassOnly: true })
  changed?: Date;

  /**
   * User that last modified the object
   */
  @SpeakeasyMetadata()
  @Expose({ name: "changed_by" })
  @Type(() => ChangedBy)
  changedBy?: ChangedBy;

  /**
   * Id of the connected target in a multi-environment targets.
   *
   * @remarks
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "connected_target" })
  connectedTarget?: string;

  /**
   * Certain operations (e.g. changing a target's `type`) may require going through billing. Until the change is reverted or the billing is settled.
   *
   * @remarks
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "enabled" })
  enabled?: boolean;

  /**
   * Multi-environment targets can identify environments using this property.
   *
   * @remarks
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "environment" })
  environment?: EnvironmentEnum;

  /**
   * Object id.
   */
  @SpeakeasyMetadata()
  @Expose({ name: "id" })
  id?: string;

  /**
   * User labels for the scope. (This feature is currently only available for certain accounts,
   *
   * @remarks
   * please contact our support if you are interested in using it)
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "labels" })
  labels?: string[];

  /**
   * Custom name for the resource
   */
  @SpeakeasyMetadata()
  @Expose({ name: "name" })
  name?: string;

  /**
   * * default - default report, no extra information added
   *
   * @remarks
   * * owasp - adds table on OWASP Top 10 most critical web application risks
   * * pci - adds table on PCI requirements
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "report_type" })
  reportType?: ReportTypeEnum;

  /**
   * * lightning - fast simple scan
   *
   * @remarks
   * * normal - default profile
   * * full - does everything the default profile does and adds boolean based
   * SQL injection tests
   * * safe - doesn't use any content changing methods (no POST, DELETE, etc)
   * and tries fewer payloads for SQL injection tests
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "scan_profile" })
  scanProfile?: ScanProfileEnum;

  /**
   * Main resource associated with a target
   */
  @SpeakeasyMetadata()
  @Expose({ name: "site" })
  @Type(() => Site)
  site?: Site;

  /**
   * The type of a target determines what the limitations imposed on a
   *
   * @remarks
   * target.
   * * free - Every account is allowed to have 5 free targets, these targets
   * do not need to be verified but can only perform lightning
   * scans.
   * * single - Single environment targets need to be verified but are
   * allowed to run any type of scan allowed by the plan.
   * * multi - Multi environment targets are used when you want
   * to scan the same application in different environments.
   *
   */
  @SpeakeasyMetadata()
  @Expose({ name: "type" })
  type?: TargetTypeEnum;
}
