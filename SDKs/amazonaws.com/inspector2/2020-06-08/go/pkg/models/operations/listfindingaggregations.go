// Code generated by Speakeasy (https://speakeasyapi.dev). DO NOT EDIT.

package operations

import (
	"encoding/json"
	"fmt"
	"net/http"
	"openapi/pkg/models/shared"
)

type ListFindingAggregationsQueryParams struct {
	// Pagination limit
	MaxResults *string `queryParam:"style=form,explode=true,name=maxResults"`
	// Pagination token
	NextToken *string `queryParam:"style=form,explode=true,name=nextToken"`
}

type ListFindingAggregationsHeaders struct {
	XAmzAlgorithm     *string `header:"style=simple,explode=false,name=X-Amz-Algorithm"`
	XAmzContentSha256 *string `header:"style=simple,explode=false,name=X-Amz-Content-Sha256"`
	XAmzCredential    *string `header:"style=simple,explode=false,name=X-Amz-Credential"`
	XAmzDate          *string `header:"style=simple,explode=false,name=X-Amz-Date"`
	XAmzSecurityToken *string `header:"style=simple,explode=false,name=X-Amz-Security-Token"`
	XAmzSignature     *string `header:"style=simple,explode=false,name=X-Amz-Signature"`
	XAmzSignedHeaders *string `header:"style=simple,explode=false,name=X-Amz-SignedHeaders"`
}

// ListFindingAggregationsRequestBodyAggregationRequest - Contains details about an aggregation request.
type ListFindingAggregationsRequestBodyAggregationRequest struct {
	AccountAggregation         *shared.AccountAggregation         `json:"accountAggregation,omitempty"`
	AmiAggregation             *shared.AmiAggregation             `json:"amiAggregation,omitempty"`
	AwsEcrContainerAggregation *shared.AwsEcrContainerAggregation `json:"awsEcrContainerAggregation,omitempty"`
	Ec2InstanceAggregation     *shared.Ec2InstanceAggregation     `json:"ec2InstanceAggregation,omitempty"`
	FindingTypeAggregation     *shared.FindingTypeAggregation     `json:"findingTypeAggregation,omitempty"`
	ImageLayerAggregation      *shared.ImageLayerAggregation      `json:"imageLayerAggregation,omitempty"`
	LambdaFunctionAggregation  *shared.LambdaFunctionAggregation  `json:"lambdaFunctionAggregation,omitempty"`
	LambdaLayerAggregation     *shared.LambdaLayerAggregation     `json:"lambdaLayerAggregation,omitempty"`
	PackageAggregation         *shared.PackageAggregation         `json:"packageAggregation,omitempty"`
	RepositoryAggregation      *shared.RepositoryAggregation      `json:"repositoryAggregation,omitempty"`
	TitleAggregation           *shared.TitleAggregation           `json:"titleAggregation,omitempty"`
}

// ListFindingAggregationsRequestBodyAggregationTypeEnum - The type of the aggregation request.
type ListFindingAggregationsRequestBodyAggregationTypeEnum string

const (
	ListFindingAggregationsRequestBodyAggregationTypeEnumFindingType       ListFindingAggregationsRequestBodyAggregationTypeEnum = "FINDING_TYPE"
	ListFindingAggregationsRequestBodyAggregationTypeEnumPackage           ListFindingAggregationsRequestBodyAggregationTypeEnum = "PACKAGE"
	ListFindingAggregationsRequestBodyAggregationTypeEnumTitle             ListFindingAggregationsRequestBodyAggregationTypeEnum = "TITLE"
	ListFindingAggregationsRequestBodyAggregationTypeEnumRepository        ListFindingAggregationsRequestBodyAggregationTypeEnum = "REPOSITORY"
	ListFindingAggregationsRequestBodyAggregationTypeEnumAmi               ListFindingAggregationsRequestBodyAggregationTypeEnum = "AMI"
	ListFindingAggregationsRequestBodyAggregationTypeEnumAwsEc2Instance    ListFindingAggregationsRequestBodyAggregationTypeEnum = "AWS_EC2_INSTANCE"
	ListFindingAggregationsRequestBodyAggregationTypeEnumAwsEcrContainer   ListFindingAggregationsRequestBodyAggregationTypeEnum = "AWS_ECR_CONTAINER"
	ListFindingAggregationsRequestBodyAggregationTypeEnumImageLayer        ListFindingAggregationsRequestBodyAggregationTypeEnum = "IMAGE_LAYER"
	ListFindingAggregationsRequestBodyAggregationTypeEnumAccount           ListFindingAggregationsRequestBodyAggregationTypeEnum = "ACCOUNT"
	ListFindingAggregationsRequestBodyAggregationTypeEnumAwsLambdaFunction ListFindingAggregationsRequestBodyAggregationTypeEnum = "AWS_LAMBDA_FUNCTION"
	ListFindingAggregationsRequestBodyAggregationTypeEnumLambdaLayer       ListFindingAggregationsRequestBodyAggregationTypeEnum = "LAMBDA_LAYER"
)

func (e *ListFindingAggregationsRequestBodyAggregationTypeEnum) UnmarshalJSON(data []byte) error {
	var s string
	if err := json.Unmarshal(data, &s); err != nil {
		return err
	}
	switch s {
	case "FINDING_TYPE":
		fallthrough
	case "PACKAGE":
		fallthrough
	case "TITLE":
		fallthrough
	case "REPOSITORY":
		fallthrough
	case "AMI":
		fallthrough
	case "AWS_EC2_INSTANCE":
		fallthrough
	case "AWS_ECR_CONTAINER":
		fallthrough
	case "IMAGE_LAYER":
		fallthrough
	case "ACCOUNT":
		fallthrough
	case "AWS_LAMBDA_FUNCTION":
		fallthrough
	case "LAMBDA_LAYER":
		*e = ListFindingAggregationsRequestBodyAggregationTypeEnum(s)
		return nil
	default:
		return fmt.Errorf("invalid value for ListFindingAggregationsRequestBodyAggregationTypeEnum: %s", s)
	}
}

type ListFindingAggregationsRequestBody struct {
	// The Amazon Web Services account IDs to retrieve finding aggregation data for.
	AccountIds []shared.StringFilter `json:"accountIds,omitempty"`
	// Contains details about an aggregation request.
	AggregationRequest *ListFindingAggregationsRequestBodyAggregationRequest `json:"aggregationRequest,omitempty"`
	// The type of the aggregation request.
	AggregationType ListFindingAggregationsRequestBodyAggregationTypeEnum `json:"aggregationType"`
	// The maximum number of results to return in the response.
	MaxResults *int64 `json:"maxResults,omitempty"`
	// A token to use for paginating results that are returned in the response. Set the value of this parameter to null for the first request to a list action. For subsequent calls, use the <code>NextToken</code> value returned from the previous request to continue listing results after the first page.
	NextToken *string `json:"nextToken,omitempty"`
}

type ListFindingAggregationsRequest struct {
	QueryParams ListFindingAggregationsQueryParams
	Headers     ListFindingAggregationsHeaders
	Request     ListFindingAggregationsRequestBody `request:"mediaType=application/json"`
}

type ListFindingAggregationsResponse struct {
	ContentType string
	// InternalServerException
	InternalServerException interface{}
	// Success
	ListFindingAggregationsResponse *shared.ListFindingAggregationsResponse
	StatusCode                      int
	RawResponse                     *http.Response
	// ThrottlingException
	ThrottlingException interface{}
	// ValidationException
	ValidationException interface{}
}
